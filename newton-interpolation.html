<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 11 Newton Interpolation | MAT325 E-Pack: Numerical Analysis</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 11 Newton Interpolation | MAT325 E-Pack: Numerical Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 11 Newton Interpolation | MAT325 E-Pack: Numerical Analysis" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Cheng Peng" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lagrange-interpolation.html"/>
<link rel="next" href="gauss-elimination-method.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<center><li><a href="./"><font color = "darkred"><b>MAT 325 E-Coursepack: Numerical Analysis</b></font></a><br><font color = "navy">Cheng Peng</font></li></center>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="calculus-review.html"><a href="calculus-review.html"><i class="fa fa-check"></i><b>2</b> Calculus Review</a>
<ul>
<li class="chapter" data-level="2.1" data-path="calculus-review.html"><a href="calculus-review.html#limits-and-continuity"><i class="fa fa-check"></i><b>2.1</b> Limits and Continuity</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="calculus-review.html"><a href="calculus-review.html#limits"><i class="fa fa-check"></i><b>2.1.1</b> Limits</a></li>
<li class="chapter" data-level="2.1.2" data-path="calculus-review.html"><a href="calculus-review.html#continuity"><i class="fa fa-check"></i><b>2.1.2</b> Continuity</a></li>
<li class="chapter" data-level="2.1.3" data-path="calculus-review.html"><a href="calculus-review.html#convergence-of-a-sequence"><i class="fa fa-check"></i><b>2.1.3</b> Convergence of A Sequence</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="calculus-review.html"><a href="calculus-review.html#differentiation"><i class="fa fa-check"></i><b>2.2</b> Differentiation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="calculus-review.html"><a href="calculus-review.html#definition"><i class="fa fa-check"></i><b>2.2.1</b> Definition</a></li>
<li class="chapter" data-level="2.2.2" data-path="calculus-review.html"><a href="calculus-review.html#properties"><i class="fa fa-check"></i><b>2.2.2</b> Properties</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="calculus-review.html"><a href="calculus-review.html#integration"><i class="fa fa-check"></i><b>2.3</b> Integration</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="calculus-review.html"><a href="calculus-review.html#series-vs-sequence"><i class="fa fa-check"></i><b>2.3.1</b> Series vs Sequence</a></li>
<li class="chapter" data-level="2.3.2" data-path="calculus-review.html"><a href="calculus-review.html#definition-of-definite-integral"><i class="fa fa-check"></i><b>2.3.2</b> Definition of Definite Integral</a></li>
<li class="chapter" data-level="2.3.3" data-path="calculus-review.html"><a href="calculus-review.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html"><i class="fa fa-check"></i><b>3</b> Scientific Computing with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#vectors-and-matrices"><i class="fa fa-check"></i><b>3.1</b> Vectors and Matrices</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#vectors"><i class="fa fa-check"></i><b>3.1.1</b> Vectors</a></li>
<li class="chapter" data-level="3.1.2" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#matrices"><i class="fa fa-check"></i><b>3.1.2</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#built-in-mathematical-functions-and-operators"><i class="fa fa-check"></i><b>3.2</b> Built-in Mathematical Functions and Operators</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#arithmetic-operators"><i class="fa fa-check"></i><b>3.2.1</b> Arithmetic Operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#basic-mathematical-functions"><i class="fa fa-check"></i><b>3.2.2</b> Basic Mathematical Functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#trigonometry"><i class="fa fa-check"></i><b>3.2.3</b> Trigonometry</a></li>
<li class="chapter" data-level="3.2.4" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#linear-algebra"><i class="fa fa-check"></i><b>3.2.4</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#graphic-functions-in-base-r"><i class="fa fa-check"></i><b>3.3</b> Graphic Functions in Base R</a></li>
<li class="chapter" data-level="3.4" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#rounding-and-related-functions"><i class="fa fa-check"></i><b>3.4</b> Rounding and Related Functions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#round"><i class="fa fa-check"></i><b>3.4.1</b> round()</a></li>
<li class="chapter" data-level="3.4.2" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#controlling-number-of-displayed-digits"><i class="fa fa-check"></i><b>3.4.2</b> Controlling Number of Displayed Digits</a></li>
<li class="chapter" data-level="3.4.3" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#signif"><i class="fa fa-check"></i><b>3.4.3</b> <code>Signif()</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#floor-and-ceiling"><i class="fa fa-check"></i><b>3.4.4</b> <code>floor()</code> and <code>ceiling()</code></a></li>
<li class="chapter" data-level="3.4.5" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#trunc"><i class="fa fa-check"></i><b>3.4.5</b> <code>trunc()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#control-statements"><i class="fa fa-check"></i><b>3.5</b> Control Statements</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#conditional-statements"><i class="fa fa-check"></i><b>3.5.1</b> Conditional Statements</a></li>
<li class="chapter" data-level="3.5.2" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#loops-in-r"><i class="fa fa-check"></i><b>3.5.2</b> Loops in R</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#numerical-example"><i class="fa fa-check"></i><b>3.6</b> Numerical Example</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#version-1"><i class="fa fa-check"></i><b>3.6.1</b> VERSION 1</a></li>
<li class="chapter" data-level="3.6.2" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#version-2"><i class="fa fa-check"></i><b>3.6.2</b> Version 2</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#user-defined-functions"><i class="fa fa-check"></i><b>3.7</b> User Defined Functions</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="scientific-computing-with-r.html"><a href="scientific-computing-with-r.html#writing-r-functions-for-root-finding-methods"><i class="fa fa-check"></i><b>3.7.1</b> Writing R Functions for Root-finding Methods</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html"><i class="fa fa-check"></i><b>4</b> Basics of Data Representation and Error Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#data-representation"><i class="fa fa-check"></i><b>4.1</b> Data Representation</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#number-systems"><i class="fa fa-check"></i><b>4.1.1</b> Number Systems</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#how-data-is-stored-in-computer-memory"><i class="fa fa-check"></i><b>4.2</b> How data is stored in computer memory</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#how-integers-are-stored-in-memory"><i class="fa fa-check"></i><b>4.2.1</b> How integers are stored in memory?</a></li>
<li class="chapter" data-level="4.2.2" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#floating-point-numbers"><i class="fa fa-check"></i><b>4.2.2</b> Floating-point Numbers</a></li>
<li class="chapter" data-level="4.2.3" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#how-floating-point-numbers-are-stored-in-memory"><i class="fa fa-check"></i><b>4.2.3</b> How Floating-point Numbers Are Stored in Memory?</a></li>
<li class="chapter" data-level="4.2.4" data-path="basics-of-data-representation-and-error-analysis.html"><a href="basics-of-data-representation-and-error-analysis.html#basic-types-errors-in-error-analysis"><i class="fa fa-check"></i><b>4.2.4</b> Basic Types Errors in Error Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html"><i class="fa fa-check"></i><b>5</b> Error Analysis, Algorithms and Convergence</a>
<ul>
<li class="chapter" data-level="5.1" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#error-analysis"><i class="fa fa-check"></i><b>5.1</b> Error Analysis</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#understanding-numerical-error"><i class="fa fa-check"></i><b>5.1.1</b> Understanding Numerical Error</a></li>
<li class="chapter" data-level="5.1.2" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#error-classification"><i class="fa fa-check"></i><b>5.1.2</b> Error Classification</a></li>
<li class="chapter" data-level="5.1.3" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#approximation-significant-digits-figures"><i class="fa fa-check"></i><b>5.1.3</b> Approximation Significant Digits (Figures)</a></li>
<li class="chapter" data-level="5.1.4" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#nested-arithmetic"><i class="fa fa-check"></i><b>5.1.4</b> Nested Arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#algorithms-and-convergence"><i class="fa fa-check"></i><b>5.2</b> Algorithms and Convergence</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#algorithm-and-psuedo-code"><i class="fa fa-check"></i><b>5.2.1</b> Algorithm and Psuedo-code</a></li>
<li class="chapter" data-level="5.2.2" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#rules-of-pseudo-code"><i class="fa fa-check"></i><b>5.2.2</b> Rules of Pseudo-code</a></li>
<li class="chapter" data-level="5.2.3" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#stability-of-algorithms"><i class="fa fa-check"></i><b>5.2.3</b> Stability of Algorithms</a></li>
<li class="chapter" data-level="5.2.4" data-path="error-analysis-algorithms-and-convergence.html"><a href="error-analysis-algorithms-and-convergence.html#rates-of-convergence"><i class="fa fa-check"></i><b>5.2.4</b> Rates of Convergence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bisection-method.html"><a href="bisection-method.html"><i class="fa fa-check"></i><b>6</b> Bisection Method</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bisection-method.html"><a href="bisection-method.html#the-question"><i class="fa fa-check"></i><b>6.1</b> The Question</a></li>
<li class="chapter" data-level="6.2" data-path="bisection-method.html"><a href="bisection-method.html#bisection-method-1"><i class="fa fa-check"></i><b>6.2</b> Bisection Method</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bisection-method.html"><a href="bisection-method.html#the-logic-of-bisection-method"><i class="fa fa-check"></i><b>6.2.1</b> The Logic of Bisection Method</a></li>
<li class="chapter" data-level="6.2.2" data-path="bisection-method.html"><a href="bisection-method.html#bisection-algorithm"><i class="fa fa-check"></i><b>6.2.2</b> Bisection Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bisection-method.html"><a href="bisection-method.html#error-analysis-1"><i class="fa fa-check"></i><b>6.3</b> Error Analysis</a></li>
<li class="chapter" data-level="6.4" data-path="bisection-method.html"><a href="bisection-method.html#numerical-examples."><i class="fa fa-check"></i><b>6.4</b> Numerical Examples.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fixed-point-method.html"><a href="fixed-point-method.html"><i class="fa fa-check"></i><b>7</b> Fixed Point Method</a>
<ul>
<li class="chapter" data-level="7.1" data-path="fixed-point-method.html"><a href="fixed-point-method.html#some-theories-of-the-fixed-point-method"><i class="fa fa-check"></i><b>7.1</b> Some Theories of the Fixed Point Method</a></li>
<li class="chapter" data-level="7.2" data-path="fixed-point-method.html"><a href="fixed-point-method.html#fixed-point-iteration"><i class="fa fa-check"></i><b>7.2</b> Fixed Point Iteration</a></li>
<li class="chapter" data-level="7.3" data-path="fixed-point-method.html"><a href="fixed-point-method.html#error-analysis-2"><i class="fa fa-check"></i><b>7.3</b> Error Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="fixed-point-method.html"><a href="fixed-point-method.html#numerical-example-1"><i class="fa fa-check"></i><b>7.4</b> Numerical Example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="newtons-method.html"><a href="newtons-method.html"><i class="fa fa-check"></i><b>8</b> Newton’s Method</a>
<ul>
<li class="chapter" data-level="8.1" data-path="newtons-method.html"><a href="newtons-method.html#notations-big-o-and-little-o"><i class="fa fa-check"></i><b>8.1</b> Notations: Big O and Little o</a></li>
<li class="chapter" data-level="8.2" data-path="newtons-method.html"><a href="newtons-method.html#foundations-of-newton-method"><i class="fa fa-check"></i><b>8.2</b> Foundations of Newton Method</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="newtons-method.html"><a href="newtons-method.html#the-algorithmic-logic"><i class="fa fa-check"></i><b>8.2.1</b> The Algorithmic Logic</a></li>
<li class="chapter" data-level="8.2.2" data-path="newtons-method.html"><a href="newtons-method.html#initial-starting-value-matters"><i class="fa fa-check"></i><b>8.2.2</b> Initial Starting Value Matters</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="newtons-method.html"><a href="newtons-method.html#algorithm-and-pseudo-code"><i class="fa fa-check"></i><b>8.3</b> Algorithm and Pseudo-code</a></li>
<li class="chapter" data-level="8.4" data-path="newtons-method.html"><a href="newtons-method.html#error-analysis-3"><i class="fa fa-check"></i><b>8.4</b> Error Analysis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="secant-method.html"><a href="secant-method.html"><i class="fa fa-check"></i><b>9</b> Secant Method</a>
<ul>
<li class="chapter" data-level="9.1" data-path="secant-method.html"><a href="secant-method.html#secant-method-1"><i class="fa fa-check"></i><b>9.1</b> Secant Method</a></li>
<li class="chapter" data-level="9.2" data-path="secant-method.html"><a href="secant-method.html#secant-algorithm-and-implementation"><i class="fa fa-check"></i><b>9.2</b> Secant Algorithm and Implementation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="secant-method.html"><a href="secant-method.html#implementation-with-r"><i class="fa fa-check"></i><b>9.2.1</b> Implementation with R</a></li>
<li class="chapter" data-level="9.2.2" data-path="secant-method.html"><a href="secant-method.html#numerical-examples"><i class="fa fa-check"></i><b>9.2.2</b> Numerical Examples</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="secant-method.html"><a href="secant-method.html#error-analysis-4"><i class="fa fa-check"></i><b>9.3</b> Error Analysis</a></li>
<li class="chapter" data-level="9.4" data-path="secant-method.html"><a href="secant-method.html#false-position-method"><i class="fa fa-check"></i><b>9.4</b> False Position Method</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html"><i class="fa fa-check"></i><b>10</b> Lagrange Interpolation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#concepts-of-interpolation-method"><i class="fa fa-check"></i><b>10.1</b> Concepts of Interpolation Method</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#data-fitting-interpolation"><i class="fa fa-check"></i><b>10.1.1</b> Data-fitting / Interpolation:</a></li>
<li class="chapter" data-level="10.1.2" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#functional-equation-curve-approximation"><i class="fa fa-check"></i><b>10.1.2</b> Functional Equation (Curve Approximation)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#the-lagrange-interpolation"><i class="fa fa-check"></i><b>10.2</b> The Lagrange Interpolation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#linear-lagrange-interpolation"><i class="fa fa-check"></i><b>10.2.1</b> Linear Lagrange Interpolation</a></li>
<li class="chapter" data-level="10.2.2" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#quadratic-lagrange-interpolation"><i class="fa fa-check"></i><b>10.2.2</b> Quadratic Lagrange Interpolation</a></li>
<li class="chapter" data-level="10.2.3" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#general-lagrange-interpolation"><i class="fa fa-check"></i><b>10.2.3</b> General Lagrange Interpolation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#lagrange-algorithm-and-implementation"><i class="fa fa-check"></i><b>10.3</b> Lagrange Algorithm and Implementation</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#pseudo-code"><i class="fa fa-check"></i><b>10.3.1</b> Pseudo-code</a></li>
<li class="chapter" data-level="10.3.2" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#r-function-with-scalar-input"><i class="fa fa-check"></i><b>10.3.2</b> R Function with Scalar Input</a></li>
<li class="chapter" data-level="10.3.3" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#r-function-with-vector-input"><i class="fa fa-check"></i><b>10.3.3</b> R Function with Vector Input</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="lagrange-interpolation.html"><a href="lagrange-interpolation.html#error-analysis-5"><i class="fa fa-check"></i><b>10.4</b> Error Analysis</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="newton-interpolation.html"><a href="newton-interpolation.html"><i class="fa fa-check"></i><b>11</b> Newton Interpolation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="newton-interpolation.html"><a href="newton-interpolation.html#some-definitions"><i class="fa fa-check"></i><b>11.1</b> Some Definitions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="newton-interpolation.html"><a href="newton-interpolation.html#definitions"><i class="fa fa-check"></i><b>11.1.1</b> Definitions</a></li>
<li class="chapter" data-level="11.1.2" data-path="newton-interpolation.html"><a href="newton-interpolation.html#calculation-of-divided-difference"><i class="fa fa-check"></i><b>11.1.2</b> Calculation of Divided Difference</a></li>
<li class="chapter" data-level="11.1.3" data-path="newton-interpolation.html"><a href="newton-interpolation.html#algorithm-of-calculating-divided-differences"><i class="fa fa-check"></i><b>11.1.3</b> Algorithm of Calculating Divided Differences</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="newton-interpolation.html"><a href="newton-interpolation.html#newton-interpolation-polynomial"><i class="fa fa-check"></i><b>11.2</b> Newton Interpolation Polynomial</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="newton-interpolation.html"><a href="newton-interpolation.html#definition-of-newton-interpolation"><i class="fa fa-check"></i><b>11.2.1</b> Definition of Newton Interpolation</a></li>
<li class="chapter" data-level="11.2.2" data-path="newton-interpolation.html"><a href="newton-interpolation.html#newton-interpolation-algorithm"><i class="fa fa-check"></i><b>11.2.2</b> Newton Interpolation Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="newton-interpolation.html"><a href="newton-interpolation.html#error-analysis-6"><i class="fa fa-check"></i><b>11.3</b> Error Analysis</a></li>
<li class="chapter" data-level="11.4" data-path="newton-interpolation.html"><a href="newton-interpolation.html#some-remarks-of-newton-interpolation"><i class="fa fa-check"></i><b>11.4</b> Some Remarks of Newton Interpolation</a></li>
<li class="chapter" data-level="11.5" data-path="newton-interpolation.html"><a href="newton-interpolation.html#implicit-loops-in-r-programming"><i class="fa fa-check"></i><b>11.5</b> Implicit Loops in R Programming</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="newton-interpolation.html"><a href="newton-interpolation.html#implicit-in-r-primitive-functions"><i class="fa fa-check"></i><b>11.5.1</b> Implicit in R Primitive Functions</a></li>
<li class="chapter" data-level="11.5.2" data-path="newton-interpolation.html"><a href="newton-interpolation.html#some-vectorized-primitive-functions"><i class="fa fa-check"></i><b>11.5.2</b> Some Vectorized Primitive Functions</a></li>
<li class="chapter" data-level="11.5.3" data-path="newton-interpolation.html"><a href="newton-interpolation.html#divided-difference-variants"><i class="fa fa-check"></i><b>11.5.3</b> Divided Difference Variants</a></li>
<li class="chapter" data-level="11.5.4" data-path="newton-interpolation.html"><a href="newton-interpolation.html#vectorizing-newtoninterp"><i class="fa fa-check"></i><b>11.5.4</b> Vectorizing <strong>NewtonInterp()</strong></a></li>
<li class="chapter" data-level="11.5.5" data-path="newton-interpolation.html"><a href="newton-interpolation.html#code-efficiency-with-implivit-loops"><i class="fa fa-check"></i><b>11.5.5</b> Code Efficiency with Implivit Loops</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="gauss-elimination-method.html"><a href="gauss-elimination-method.html"><i class="fa fa-check"></i><b>12</b> Gauss Elimination Method</a>
<ul>
<li class="chapter" data-level="12.1" data-path="gauss-elimination-method.html"><a href="gauss-elimination-method.html#naive-gaussian-elimination-methods"><i class="fa fa-check"></i><b>12.1</b> Naive Gaussian Elimination Methods</a></li>
<li class="chapter" data-level="12.2" data-path="gauss-elimination-method.html"><a href="gauss-elimination-method.html#gaussian-elimination-algorithm"><i class="fa fa-check"></i><b>12.2</b> Gaussian Elimination Algorithm</a></li>
<li class="chapter" data-level="12.3" data-path="gauss-elimination-method.html"><a href="gauss-elimination-method.html#gauss-jordan-elimination-optional"><i class="fa fa-check"></i><b>12.3</b> Gauss-Jordan Elimination (<code>Optional</code>)</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html"><i class="fa fa-check"></i><b>13</b> Determinant and Inversion of Matrices</a>
<ul>
<li class="chapter" data-level="13.1" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html#concepts-of-matrix-a-review"><i class="fa fa-check"></i><b>13.1</b> Concepts of Matrix: A Review</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html#definitions-of-some-special-matrices"><i class="fa fa-check"></i><b>13.1.1</b> Definitions of Some Special Matrices</a></li>
<li class="chapter" data-level="13.1.2" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html#binary-operations"><i class="fa fa-check"></i><b>13.1.2</b> Binary Operations</a></li>
<li class="chapter" data-level="13.1.3" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html#unary-operations"><i class="fa fa-check"></i><b>13.1.3</b> Unary Operations</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html#determinant-of-a-square-matrix"><i class="fa fa-check"></i><b>13.2</b> Determinant of a Square Matrix</a></li>
<li class="chapter" data-level="13.3" data-path="determinant-and-inversion-of-matrices.html"><a href="determinant-and-inversion-of-matrices.html#matrix-inversion"><i class="fa fa-check"></i><b>13.3</b> Matrix Inversion</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="matrix-factorization.html"><a href="matrix-factorization.html"><i class="fa fa-check"></i><b>14</b> Matrix Factorization</a>
<ul>
<li class="chapter" data-level="14.1" data-path="matrix-factorization.html"><a href="matrix-factorization.html#elementary-and-permutation-matrices"><i class="fa fa-check"></i><b>14.1</b> Elementary and Permutation Matrices</a></li>
<li class="chapter" data-level="14.2" data-path="matrix-factorization.html"><a href="matrix-factorization.html#lu-factorization-algorithm"><i class="fa fa-check"></i><b>14.2</b> LU Factorization Algorithm</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="matrix-factorization.html"><a href="matrix-factorization.html#row-operations-with-row-swapping"><i class="fa fa-check"></i><b>14.2.1</b> Row Operations with Row Swapping</a></li>
<li class="chapter" data-level="14.2.2" data-path="matrix-factorization.html"><a href="matrix-factorization.html#row-operations-with-row-swapping-1"><i class="fa fa-check"></i><b>14.2.2</b> Row Operations with Row-swapping</a></li>
<li class="chapter" data-level="14.2.3" data-path="matrix-factorization.html"><a href="matrix-factorization.html#lu-algorithm"><i class="fa fa-check"></i><b>14.2.3</b> LU ALgorithm</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="matrix-factorization.html"><a href="matrix-factorization.html#benefit-of-lu-factorization"><i class="fa fa-check"></i><b>14.3</b> Benefit of LU Factorization</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="least-square-approximation.html"><a href="least-square-approximation.html"><i class="fa fa-check"></i><b>15</b> Least Square Approximation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="least-square-approximation.html"><a href="least-square-approximation.html#concepts-of-least-square-approximation"><i class="fa fa-check"></i><b>15.1</b> Concepts of Least Square Approximation</a></li>
<li class="chapter" data-level="15.2" data-path="least-square-approximation.html"><a href="least-square-approximation.html#approximating-one-variable-linear-function"><i class="fa fa-check"></i><b>15.2</b> Approximating One-variable Linear Function</a></li>
<li class="chapter" data-level="15.3" data-path="least-square-approximation.html"><a href="least-square-approximation.html#approximating-multiple-variable-linear-function"><i class="fa fa-check"></i><b>15.3</b> Approximating Multiple-variable Linear Function</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="least-square-approximation.html"><a href="least-square-approximation.html#an-extension-of-the-height-example"><i class="fa fa-check"></i><b>15.3.1</b> An Extension of the Height Example</a></li>
<li class="chapter" data-level="15.3.2" data-path="least-square-approximation.html"><a href="least-square-approximation.html#approximating-general-multi-variables-linear-functions"><i class="fa fa-check"></i><b>15.3.2</b> Approximating General Multi-variables Linear Functions</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="least-square-approximation.html"><a href="least-square-approximation.html#approximating-one-variable-polynomial-function"><i class="fa fa-check"></i><b>15.4</b> Approximating One-variable Polynomial Function</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="least-square-approximation.html"><a href="least-square-approximation.html#approximating-quadratic-function"><i class="fa fa-check"></i><b>15.4.1</b> Approximating Quadratic Function</a></li>
<li class="chapter" data-level="15.4.2" data-path="least-square-approximation.html"><a href="least-square-approximation.html#approximating-general-polynomial-functions"><i class="fa fa-check"></i><b>15.4.2</b> Approximating General Polynomial Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="concepts-of-spline-interpolations.html"><a href="concepts-of-spline-interpolations.html"><i class="fa fa-check"></i><b>16</b> Concepts of Spline Interpolations</a>
<ul>
<li class="chapter" data-level="16.1" data-path="concepts-of-spline-interpolations.html"><a href="concepts-of-spline-interpolations.html#linear-splines"><i class="fa fa-check"></i><b>16.1</b> Linear Splines</a></li>
<li class="chapter" data-level="16.2" data-path="concepts-of-spline-interpolations.html"><a href="concepts-of-spline-interpolations.html#quadratic-spline-interpolation"><i class="fa fa-check"></i><b>16.2</b> Quadratic Spline Interpolation</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="concepts-of-spline-interpolations.html"><a href="concepts-of-spline-interpolations.html#formulation-of-quadratic-spline"><i class="fa fa-check"></i><b>16.2.1</b> Formulation of Quadratic Spline</a></li>
<li class="chapter" data-level="16.2.2" data-path="concepts-of-spline-interpolations.html"><a href="concepts-of-spline-interpolations.html#matrix-representation-of-quadratic-spline-problem"><i class="fa fa-check"></i><b>16.2.2</b> Matrix Representation of Quadratic Spline Problem</a></li>
<li class="chapter" data-level="16.2.3" data-path="concepts-of-spline-interpolations.html"><a href="concepts-of-spline-interpolations.html#algorithm-of-quadratic-spline"><i class="fa fa-check"></i><b>16.2.3</b> Algorithm of Quadratic Spline</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html"><i class="fa fa-check"></i><b>17</b> Cubic Spline Interpolation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html#cubic-splines"><i class="fa fa-check"></i><b>17.1</b> Cubic Splines</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html#formulation-of-cubic-spline"><i class="fa fa-check"></i><b>17.1.1</b> Formulation of Cubic Spline</a></li>
<li class="chapter" data-level="17.1.2" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html#construction-of-cubic-splines"><i class="fa fa-check"></i><b>17.1.2</b> Construction of Cubic Splines</a></li>
<li class="chapter" data-level="17.1.3" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html#cubic-spline-algorithm"><i class="fa fa-check"></i><b>17.1.3</b> Cubic Spline Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html#clamped-splines"><i class="fa fa-check"></i><b>17.2</b> Clamped Splines</a></li>
<li class="chapter" data-level="17.3" data-path="cubic-spline-interpolation.html"><a href="cubic-spline-interpolation.html#error-analysis-7"><i class="fa fa-check"></i><b>17.3</b> Error Analysis</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html"><i class="fa fa-check"></i><b>18</b> Newton Method for Nonlinear System and Optimization</a>
<ul>
<li class="chapter" data-level="18.1" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html#multivariate-taylor-expansion"><i class="fa fa-check"></i><b>18.1</b> Multivariate Taylor Expansion</a></li>
<li class="chapter" data-level="18.2" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html#newton-method-for-nonlinear-systems"><i class="fa fa-check"></i><b>18.2</b> Newton Method for Nonlinear Systems</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html#system-of-two-nonlinear-equations"><i class="fa fa-check"></i><b>18.2.1</b> System of Two Nonlinear Equations</a></li>
<li class="chapter" data-level="18.2.2" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html#newton-algorithm"><i class="fa fa-check"></i><b>18.2.2</b> Newton Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html#optimization"><i class="fa fa-check"></i><b>18.3</b> Optimization</a></li>
<li class="chapter" data-level="18.4" data-path="newton-method-for-nonlinear-system-and-optimization.html"><a href="newton-method-for-nonlinear-system-and-optimization.html#a-case-study"><i class="fa fa-check"></i><b>18.4</b> A Case Study</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html"><i class="fa fa-check"></i><b>19</b> Numerical Integration I</a>
<ul>
<li class="chapter" data-level="19.1" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#numerical-approximation-of-derivatives"><i class="fa fa-check"></i><b>19.1</b> Numerical Approximation of Derivatives</a></li>
<li class="chapter" data-level="19.2" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#trapezoid-method"><i class="fa fa-check"></i><b>19.2</b> Trapezoid Method</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#formulation-of-trapezoid-method"><i class="fa fa-check"></i><b>19.2.1</b> Formulation of Trapezoid Method</a></li>
<li class="chapter" data-level="19.2.2" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#error-analysis-8"><i class="fa fa-check"></i><b>19.2.2</b> Error Analysis</a></li>
<li class="chapter" data-level="19.2.3" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#composite-trapezoid-method-and-error-analysis"><i class="fa fa-check"></i><b>19.2.3</b> Composite Trapezoid Method and Error Analysis</a></li>
<li class="chapter" data-level="19.2.4" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#trapezoid-algorithm"><i class="fa fa-check"></i><b>19.2.4</b> Trapezoid Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#simpsons-one-third-rule"><i class="fa fa-check"></i><b>19.3</b> Simpson’s One-third Rule</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#derivation-of-simpsons-rule"><i class="fa fa-check"></i><b>19.3.1</b> Derivation of Simpson’s Rule</a></li>
<li class="chapter" data-level="19.3.2" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#explicit-function-on-x_i-1-x_i1"><i class="fa fa-check"></i><b>19.3.2</b> Explicit Function on <span class="math inline">\([x_{i-1}, x_{i+1}]\)</span></a></li>
<li class="chapter" data-level="19.3.3" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#the-composite-simpsons-rule"><i class="fa fa-check"></i><b>19.3.3</b> The Composite Simpsons’ Rule</a></li>
<li class="chapter" data-level="19.3.4" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#error-analysis-9"><i class="fa fa-check"></i><b>19.3.4</b> Error Analysis</a></li>
<li class="chapter" data-level="19.3.5" data-path="numerical-integration-i.html"><a href="numerical-integration-i.html#algorithm-of-simpsons-rule"><i class="fa fa-check"></i><b>19.3.5</b> Algorithm of Simpson’s Rule</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html"><i class="fa fa-check"></i><b>20</b> Romberg Integration and Gaussian Quadratures</a>
<ul>
<li class="chapter" data-level="20.1" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#richardson-extrapolation"><i class="fa fa-check"></i><b>20.1</b> Richardson Extrapolation</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#the-logic-of-the-richardson-method"><i class="fa fa-check"></i><b>20.1.1</b> The Logic of the Richardson Method</a></li>
<li class="chapter" data-level="20.1.2" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#algorithm-of-richardson-method"><i class="fa fa-check"></i><b>20.1.2</b> Algorithm of Richardson Method</a></li>
<li class="chapter" data-level="20.1.3" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#higher-order-extrapolation"><i class="fa fa-check"></i><b>20.1.3</b> Higher Order Extrapolation</a></li>
<li class="chapter" data-level="20.1.4" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#algorithm-and-code"><i class="fa fa-check"></i><b>20.1.4</b> Algorithm and Code</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#romberg-integration"><i class="fa fa-check"></i><b>20.2</b> Romberg Integration</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#approximation-formula-and-error-analysis"><i class="fa fa-check"></i><b>20.2.1</b> Approximation formula and Error Analysis</a></li>
<li class="chapter" data-level="20.2.2" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#romberg-algorithm"><i class="fa fa-check"></i><b>20.2.2</b> Romberg Algorithm</a></li>
<li class="chapter" data-level="20.2.3" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#r-code"><i class="fa fa-check"></i><b>20.2.3</b> R Code</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#gaussian-quadrature"><i class="fa fa-check"></i><b>20.3</b> Gaussian Quadrature</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#two-point-gauss-legendre-formula"><i class="fa fa-check"></i><b>20.3.1</b> Two-point Gauss Legendre Formula</a></li>
<li class="chapter" data-level="20.3.2" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#general-gauss-legendre-formula"><i class="fa fa-check"></i><b>20.3.2</b> General Gauss Legendre Formula</a></li>
<li class="chapter" data-level="20.3.3" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#r-code-1"><i class="fa fa-check"></i><b>20.3.3</b> R Code</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="romberg-integration-and-gaussian-quadratures.html"><a href="romberg-integration-and-gaussian-quadratures.html#remarks"><i class="fa fa-check"></i><b>20.4</b> Remarks</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MAT325 E-Pack: Numerical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="newton-interpolation" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Topic 11</span> Newton Interpolation<a href="newton-interpolation.html#newton-interpolation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Let <span class="math inline">\(f(x)\)</span> be a function whose values are known or can be calculated at a set of points (nodes) <span class="math inline">\(\{ x_0. x_1, \cdots, x_n\}\)</span>. Assume that these points are distinct, but NOT necessarily be ordered on the real line. There exists a polynomial <span class="math inline">\(p_n(x)\)</span> of degree at most n that interpolates <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(n+1\)</span> nodes:</p>
<p><span class="math display">\[
p_n(x) = f(x_i), \ \ 0 \le i \le n.
\]</span></p>
<p>We have discussed the Lagrange form of the interpolation polynomial. In this note, we introduce Newton’s form of interpolation polynomial.</p>
<p><br />
</p>
<div id="some-definitions" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Some Definitions<a href="newton-interpolation.html#some-definitions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We introduce several definitions related to the divided differences and how to calculate the dived difference manually and programmatically.</p>
<div id="definitions" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Definitions<a href="newton-interpolation.html#definitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>The Newton form basis polynomials</strong> is defined in the following</p>
<p><span class="math display">\[
\begin{array}{lcl}
q_0(x) &amp; = &amp; a \\
q_1(x) &amp; = &amp; x-x_0  \\
q_2(x) &amp; = &amp; (x-x_0)(x-x_1) \\
\cdots &amp; \cdots &amp; \cdots \\
q_n(x) &amp; = &amp; (x-x_0)(x-x_1)\cdots(x-x_{n-1})
\end{array}
\]</span></p>
<p>The <span class="math inline">\(q_0(x), q_1(x), \cdots, 1_n(x)\)</span> is basis of span <span class="math inline">\(\{x^0, x^1, x^2, \cdots, x^n \}\)</span>.</p>
<p><br />
</p>
<p><strong>The Newton Form Polynomial</strong> is defined as
<span class="math display">\[
p_n(x) = \sum_{i=0}^nc_i q_i(x).
\]</span><br />
</p>
<p><strong>Divided Differences</strong> are defined based on the coordinates of a set of given points on the curve of <span class="math inline">\(f(x)\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="left"><span class="math inline">\(x\)</span></th>
<th align="left"><span class="math inline">\(x_0\)</span></th>
<th align="left"><span class="math inline">\(x_1\)</span></th>
<th align="left"><span class="math inline">\(x_2\)</span></th>
<th align="left"><span class="math inline">\(\cdots\)</span></th>
<th align="left"><span class="math inline">\(x_n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(f(x)\)</span></td>
<td align="left"><span class="math inline">\(f(x_0)\)</span></td>
<td align="left"><span class="math inline">\(f(x_1)\)</span></td>
<td align="left"><span class="math inline">\(f(x_2\)</span>)</td>
<td align="left"><span class="math inline">\(\cdots\)</span></td>
<td align="left"><span class="math inline">\(f(x_n)\)</span></td>
</tr>
</tbody>
</table>
<p>For <span class="math inline">\(i, j, k = 0, 1, 2, \cdots, n\)</span>,</p>
<ul>
<li><p>The zero-th order <em>divided difference</em> is <span class="math inline">\(f[x_i] = f(x_i)\)</span>.</p></li>
<li><p>The second order <em>divided difference</em> based on distinct nodes <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_j\)</span> is defined as
<span class="math display">\[
f[x_i, x_j] = \frac{f(x_i) - f(x_j)}{x_i - x_j}.
\]</span></p>
<ul>
<li>This is the slope of the secant line that passes the two given points on the curve of <span class="math inline">\(f(x)\)</span>.</li>
<li>It is also used to approximate the derivative of the function over interval <span class="math inline">\([x_i, x_j]\)</span> (assuming <span class="math inline">\(x_i &lt; x_j\)</span>) if it exists.</li>
</ul></li>
<li><p>The third order <em>divided difference</em> based on the distinct nodes <span class="math inline">\(x_i &lt; x_j &lt; x_k\)</span> is defined as</p></li>
</ul>
<p><span class="math display">\[
f[x_i, x_j, x_k] = \frac{f[x_i, x_j] - f[x_j, x_k]}{x_i-x_k}
\]</span></p>
<ul>
<li>The high order <em>divided difference</em> based on nodes <span class="math inline">\(x_0 &lt; x_1 &lt; \cdots &lt; x_n\)</span> is similarly defined as</li>
</ul>
<p><span class="math display">\[
f[x_0, x_1, \cdots, x_n] = \frac{f[x_0, x_1, \cdots, x_{n-1}] - f[x_1, \cdots, x_n]}{x_0-x_n}
\]</span></p>
</div>
<div id="calculation-of-divided-difference" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Calculation of Divided Difference<a href="newton-interpolation.html#calculation-of-divided-difference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Newton interpolation is defined based on the divided difference. We first look at the structure of the divided difference and then develop an algorithm to compute the divided difference programmatically.</p>
<ul>
<li><em>Iterative Nature of Divided Differences</em>: Consider the following given points on the curve of <span class="math inline">\(f(x)\)</span></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left"><span class="math inline">\(x\)</span></th>
<th align="left"><span class="math inline">\(x_0\)</span></th>
<th align="left"><span class="math inline">\(x_1\)</span></th>
<th align="left"><span class="math inline">\(x_2\)</span></th>
<th align="left"><span class="math inline">\(x_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(f(x)\)</span></td>
<td align="left"><span class="math inline">\(f(x_0)\)</span></td>
<td align="left"><span class="math inline">\(f(x_1)\)</span></td>
<td align="left"><span class="math inline">\(f(x_2\)</span>)</td>
<td align="left"><span class="math inline">\(f(x_3)\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Three <em>first-order divided differences</em> are defined based on the given 4 nodes. The first one based</li>
</ul>
<p><span class="math display">\[
f[x_0, x_1] = \frac{f(x_0) - f(x_1)}{x_0 - x_1}, \ \ f[x_1, x_2] = \frac{f(x_1) - f(x_2)}{x_1 - x_2}, \ \ f[x_2, x_3] = \frac{f(x_2) - f(x_3)}{x_2 - x_3},
\]</span></p>
<ul>
<li>Two second order <em>divided differences</em> are defined by</li>
</ul>
<p><span class="math display">\[
f[x_0, x_1, x_2] = \ \frac{f[x_0, x_1] - f[x_1, x_2]}{x_0-x_2} =\frac{\frac{f(x_0) - f(x_1)}{x_0 - x_1}-\frac{f(x_1) - f(x_2)}{x_1 - x_2}}{x_0 - x_2},
\]</span></p>
<p><span class="math display">\[
f[x_1, x_2, x_3] = \frac{f[x_1, x_2] - f[x_2, x_3]}{x_1-x_3} = \frac{\frac{f(x_1) - f(x_2)}{x_1 - x_2}-\frac{f(x_2) - f(x_3)}{x_2 - x_3}}{x_1 - x_3}
\]</span></p>
<ul>
<li>The third-order divided difference is defined by</li>
</ul>
<p><span class="math display">\[
f[x_0, x_1, x_2, x_3] = \frac{f[x_0, x_1, x_2] - f[x_1, x_2, x_3]}{x_0-x_3}
\]</span></p>
<p><img src="img06/w06-DividedDifferenceTable.png" width="55%" style="display: block; margin: auto;" /></p>
<p><strong>Example 1</strong>: Calculate all divided differences based on the following given data table</p>
<table>
<thead>
<tr class="header">
<th align="left"><span class="math inline">\(x\)</span></th>
<th align="left">3</th>
<th align="left">1</th>
<th align="left">5</th>
<th align="left">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(f(x)\)</span></td>
<td align="left">1</td>
<td align="left">-3</td>
<td align="left">2</td>
<td align="left">4</td>
</tr>
</tbody>
</table>
<p>Based definition, the divided differences are calculated and summarized in the following table.</p>
<p><img src="img06/w06-DividedDifferenceTableExample.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="algorithm-of-calculating-divided-differences" class="section level3 hasAnchor" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> Algorithm of Calculating Divided Differences<a href="newton-interpolation.html#algorithm-of-calculating-divided-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We re-organize the above calculation in the following matrix and use the logic to develop the pseudo-code for calculating the divided differences.</p>
<p><img src="img06/w06-codingLogic.png" width="95%" style="display: block; margin: auto;" /></p>
<p><strong>Divided Algorithm</strong></p>
<pre><code>INPUT: vec.x              (nodes)
       vec.y (or fn() )
       pred.x
       
OUTPUT: pn(pred.x)

STEP 1: Define a square zero matrix (array): A
STEP 2: Store vec.y in the first row of A
STEP 3: FOR i from 2 to ncol DO:      (Caution: 2nd row!)
            FOR j from 1 to (ncol - i + 1) DO:
                denominator = vec.x[j] - vec.x[j+i-1]
                numerator = A[i-1,j] - A[i-1, j+1]      (using previous row of A)
                A[i,j] = numerator / denominator        (next order divided difference)
            ENDFOR
        ENDFOR
STEP 4: RETURN A</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="newton-interpolation.html#cb159-1" tabindex="-1"></a>Divided.Dif <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb159-2"><a href="newton-interpolation.html#cb159-2" tabindex="-1"></a>        vec.x,          <span class="co"># input nodes:</span></span>
<span id="cb159-3"><a href="newton-interpolation.html#cb159-3" tabindex="-1"></a>        <span class="at">vec.y =</span> <span class="cn">NULL</span>,   <span class="co"># one of vec.y and fn must be given</span></span>
<span id="cb159-4"><a href="newton-interpolation.html#cb159-4" tabindex="-1"></a>        <span class="at">fn =</span> <span class="cn">NULL</span>,</span>
<span id="cb159-5"><a href="newton-interpolation.html#cb159-5" tabindex="-1"></a>        pred.x          <span class="co"># scalar x for predicting pn(pred.x)</span></span>
<span id="cb159-6"><a href="newton-interpolation.html#cb159-6" tabindex="-1"></a>         ){</span>
<span id="cb159-7"><a href="newton-interpolation.html#cb159-7" tabindex="-1"></a>   n <span class="ot">=</span> <span class="fu">length</span>(vec.x)</span>
<span id="cb159-8"><a href="newton-interpolation.html#cb159-8" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">length</span>(vec.y) <span class="sc">==</span> <span class="dv">0</span>) vec.y <span class="ot">=</span> <span class="fu">fn</span>(vec.x) <span class="co">#</span></span>
<span id="cb159-9"><a href="newton-interpolation.html#cb159-9" tabindex="-1"></a>   node.x <span class="ot">=</span> vec.x</span>
<span id="cb159-10"><a href="newton-interpolation.html#cb159-10" tabindex="-1"></a>   A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n<span class="sc">^</span><span class="dv">2</span>)), <span class="at">nrow =</span> n, <span class="at">ncol =</span> n, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb159-11"><a href="newton-interpolation.html#cb159-11" tabindex="-1"></a>   A[<span class="dv">1</span>,] <span class="ot">=</span> vec.y     <span class="co"># fill the first row with vec.y</span></span>
<span id="cb159-12"><a href="newton-interpolation.html#cb159-12" tabindex="-1"></a>   <span class="co">#</span></span>
<span id="cb159-13"><a href="newton-interpolation.html#cb159-13" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n)){</span>
<span id="cb159-14"><a href="newton-interpolation.html#cb159-14" tabindex="-1"></a>     <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb159-15"><a href="newton-interpolation.html#cb159-15" tabindex="-1"></a>      denominator <span class="ot">=</span> vec.x[j] <span class="sc">-</span> vec.x[j<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>(i<span class="dv">-2</span>)]</span>
<span id="cb159-16"><a href="newton-interpolation.html#cb159-16" tabindex="-1"></a>      numerator <span class="ot">=</span> A[i<span class="dv">-1</span>,j]<span class="sc">-</span> A[i<span class="dv">-1</span>,j<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb159-17"><a href="newton-interpolation.html#cb159-17" tabindex="-1"></a>      A[i,j] <span class="ot">=</span> numerator<span class="sc">/</span>denominator</span>
<span id="cb159-18"><a href="newton-interpolation.html#cb159-18" tabindex="-1"></a>      }</span>
<span id="cb159-19"><a href="newton-interpolation.html#cb159-19" tabindex="-1"></a>    }</span>
<span id="cb159-20"><a href="newton-interpolation.html#cb159-20" tabindex="-1"></a>  A</span>
<span id="cb159-21"><a href="newton-interpolation.html#cb159-21" tabindex="-1"></a> }</span></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="newton-interpolation.html#cb160-1" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">Divided.Dif</span>(</span>
<span id="cb160-2"><a href="newton-interpolation.html#cb160-2" tabindex="-1"></a>        <span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>),    <span class="co"># input nodes:</span></span>
<span id="cb160-3"><a href="newton-interpolation.html#cb160-3" tabindex="-1"></a>        <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>),   <span class="co"># one of vec.y and fn must be given</span></span>
<span id="cb160-4"><a href="newton-interpolation.html#cb160-4" tabindex="-1"></a>        <span class="at">fn =</span> <span class="cn">NULL</span></span>
<span id="cb160-5"><a href="newton-interpolation.html#cb160-5" tabindex="-1"></a>        )</span>
<span id="cb160-6"><a href="newton-interpolation.html#cb160-6" tabindex="-1"></a>)</span></code></pre></div>
<table style="width:33%;">
<colgroup>
<col width="12%" />
<col width="9%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">-3</td>
<td align="center">2</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1.25</td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">-0.375</td>
<td align="center">0.15</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">0.175</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p><strong>Example 2</strong>: (Example 1 of Burden and Faires’ textbook, 9th edition, page 127) Complete the divided difference table for the following data.</p>
<table style="width:19%;">
<colgroup>
<col width="5%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.0
1.3
1.6
1.9
2.2</td>
<td align="center">0.7651977
0.6200860
0.4554022
0.2818186
0.1103623</td>
</tr>
</tbody>
</table>
<p>We use the above function to calculate the divided differences.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="newton-interpolation.html#cb161-1" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">Divided.Dif</span>(</span>
<span id="cb161-2"><a href="newton-interpolation.html#cb161-2" tabindex="-1"></a>        <span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb161-3"><a href="newton-interpolation.html#cb161-3" tabindex="-1"></a>        <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>),    </span>
<span id="cb161-4"><a href="newton-interpolation.html#cb161-4" tabindex="-1"></a>        <span class="at">fn =</span> <span class="cn">NULL</span></span>
<span id="cb161-5"><a href="newton-interpolation.html#cb161-5" tabindex="-1"></a>        )</span>
<span id="cb161-6"><a href="newton-interpolation.html#cb161-6" tabindex="-1"></a>     )</span></code></pre></div>
<table style="width:72%;">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">0.7652</td>
<td align="center">0.6201</td>
<td align="center">0.4554</td>
<td align="center">0.2818</td>
<td align="center">0.1104</td>
</tr>
<tr class="even">
<td align="center">-0.4837</td>
<td align="center">-0.5489</td>
<td align="center">-0.5786</td>
<td align="center">-0.5715</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">-0.1087</td>
<td align="center">-0.04944</td>
<td align="center">0.01182</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">0.06588</td>
<td align="center">0.06807</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">0.001825</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>The resulting table is the same as the one obtained in the table of the textbook (except for rounding errors).</p>
<p><br />
</p>
</div>
</div>
<div id="newton-interpolation-polynomial" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Newton Interpolation Polynomial<a href="newton-interpolation.html#newton-interpolation-polynomial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From the definition of the divided difference, for any <span class="math inline">\(x\)</span> and <span class="math inline">\(x_0\)</span>, we have</p>
<p><span class="math display">\[
f[x,x_0] = \frac{f(x)-f(x_0)}{x-x_0}
\]</span></p>
<p>Solving for <span class="math inline">\(f(x)\)</span>, we have</p>
<p><span class="math display">\[
f(x) = f(x_0) + f[x, x_0](x - x_0).
\]</span></p>
<p>Similarly, for <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x_1\)</span>, the second order divided difference is given by</p>
<p><span class="math display">\[
f[x,x_0, x_1] = \frac{f[x, x_0]-f[x_0,x_1]}{x-x_1}
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
f[x,x_0] = f[x_0,x_1] + f[x, x_0, x_1](x - x_1).
\]</span>
That is,</p>
<p><span class="math display">\[
f(x) = f[x_0] + f[x_0, x_1](x - x_0)  + f[x, x_0, x_1](x - x_0)(x - x_1).
\]</span></p>
<p>Repeating the above calculation, we have</p>
<p><span class="math display">\[
f(x) = f[x_0] + f[x_0, x_1](x-x_0) + f[x_0, x_1, x_2](x-x_0)(x-x_1) + \cdots + f[x, x_0, \cdots, x_n](x-x_0)\cdots(x-x_{n-1})
\]</span></p>
<div id="definition-of-newton-interpolation" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Definition of Newton Interpolation<a href="newton-interpolation.html#definition-of-newton-interpolation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Based on the above derivation, we define <strong>Newton Form Interpolation Polynomial</strong> to be of the following form</p>
<p><span class="math display">\[
N_n(x) = f[x_0] + f[x_0, x_1](x-x_0) + f[x_0, x_1, x_2](x-x_0)(x-x_1) + \cdots + f[x_0, \cdots, x_n](x-x_0)\cdots(x-x_{n-1})
\]</span></p>
<p>We can see that <span class="math inline">\(N_n(x)\)</span> passes all interpolating points:</p>
<p><span class="math display">\[
N_n(x_0) = f(x_0)
\]</span></p>
<p><span class="math display">\[
N_n(x_1) = f(x_0) + f[x_0, x_1](x_1-x_0) = f(x_0) + \frac{f(x_1)-f(x_0)}{x_1-x_0}(x_1-x_0) = f(x_1)
\]</span>
In general,</p>
<p><span class="math display">\[
N_n(x_k) = f(x_k), \ \ \text{ for } \ \ 0 \le k \le n.
\]</span></p>
</div>
<div id="newton-interpolation-algorithm" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Newton Interpolation Algorithm<a href="newton-interpolation.html#newton-interpolation-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The associated <strong>divided differences</strong> in the above <strong>Newton Interpolation Polynomial</strong> are returned in the first column of the function <code>Divided.Dif()</code>. To write the algorithmic function</p>
<p><strong>Newton Interpolation Algorithm 2</strong></p>
<pre><code>INPUT:  vec.x
        vec.y or fn
        pred.x     (for prediction)
OUTPUT: pred.y     (pn(pred.x))

STEP 1: initialization:
        Divided.Dif          (function call)
        Pn = 0
        
STEP 2: FOR i from 1 to n DO:
          cumProd = 1             (initial value for the cumulative product)
          FOR j from 1 to i DO:
              cumProd = cumProd*(pred.x-vec.x[j])
          ENDFOR
          Pn = Pn + Divided.Dif[i]*cumProd
        ENDFOR
STEP 3: RETURN(Pn)
</code></pre>
<p>Next, we write an R function to implement the Newton interpolation polynomial.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="newton-interpolation.html#cb163-1" tabindex="-1"></a>NewtonInterpolation <span class="ot">=</span> <span class="cf">function</span>( vec.x,            <span class="co"># input interpolation nodes</span></span>
<span id="cb163-2"><a href="newton-interpolation.html#cb163-2" tabindex="-1"></a>                                <span class="at">vec.y =</span> <span class="cn">NULL</span>,    </span>
<span id="cb163-3"><a href="newton-interpolation.html#cb163-3" tabindex="-1"></a>                                <span class="at">fn =</span> <span class="cn">NULL</span>,        <span class="co"># either vec.y or fn must be provided</span></span>
<span id="cb163-4"><a href="newton-interpolation.html#cb163-4" tabindex="-1"></a>                                pred.x            <span class="co"># single value of x for prediction</span></span>
<span id="cb163-5"><a href="newton-interpolation.html#cb163-5" tabindex="-1"></a>                              ){</span>
<span id="cb163-6"><a href="newton-interpolation.html#cb163-6" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">length</span>(vec.y) <span class="sc">==</span><span class="dv">0</span>) vec.y <span class="ot">=</span> <span class="fu">fn</span>(vec.x)</span>
<span id="cb163-7"><a href="newton-interpolation.html#cb163-7" tabindex="-1"></a>   DivDif <span class="ot">=</span> <span class="fu">Divided.Dif</span>(vec.x, vec.y)[,<span class="dv">1</span>]       <span class="co"># the values in the first column of the div dif matrix</span></span>
<span id="cb163-8"><a href="newton-interpolation.html#cb163-8" tabindex="-1"></a>   n <span class="ot">=</span> <span class="fu">length</span>(vec.x)</span>
<span id="cb163-9"><a href="newton-interpolation.html#cb163-9" tabindex="-1"></a>   Nn <span class="ot">=</span> vec.y[<span class="dv">1</span>]                  <span class="co"># f[xo]</span></span>
<span id="cb163-10"><a href="newton-interpolation.html#cb163-10" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){            <span class="co"># Must be n - 1 according to the last term in the polynomial</span></span>
<span id="cb163-11"><a href="newton-interpolation.html#cb163-11" tabindex="-1"></a>     cumProd <span class="ot">=</span> <span class="dv">1</span>                  <span class="co"># initial value to calculate the cumulative product</span></span>
<span id="cb163-12"><a href="newton-interpolation.html#cb163-12" tabindex="-1"></a>     <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>i){               <span class="co"># forward difference formula</span></span>
<span id="cb163-13"><a href="newton-interpolation.html#cb163-13" tabindex="-1"></a>       cumProd <span class="ot">=</span> cumProd<span class="sc">*</span>(pred.x<span class="sc">-</span>vec.x[j])   <span class="co"># updating the cumulative product in the inner loop</span></span>
<span id="cb163-14"><a href="newton-interpolation.html#cb163-14" tabindex="-1"></a>     }</span>
<span id="cb163-15"><a href="newton-interpolation.html#cb163-15" tabindex="-1"></a>     Nn <span class="ot">=</span> Nn <span class="sc">+</span> DivDif[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">*</span>cumProd    <span class="co"># adding high order terms alliteratively to the Nn(x) </span></span>
<span id="cb163-16"><a href="newton-interpolation.html#cb163-16" tabindex="-1"></a>   }</span>
<span id="cb163-17"><a href="newton-interpolation.html#cb163-17" tabindex="-1"></a>  Nn                                  <span class="co"># return the value of the Newton polynomial</span></span>
<span id="cb163-18"><a href="newton-interpolation.html#cb163-18" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Example 3</strong> (Continuation of <em>example 2</em>). We evaluate the Newton interpolation polynomial <span class="math inline">\(p_4(x)\)</span> at <span class="math inline">\(x = 1.1, 1.6\)</span> and <span class="math inline">\(2.0\)</span>, respectively. Recall the given data points are</p>
<table style="width:19%;">
<colgroup>
<col width="5%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.0
1.3
1.6
1.9
2.2</td>
<td align="center">0.7651977
0.6200860
0.4554022
0.2818186
0.1103623</td>
</tr>
</tbody>
</table>
<p><strong>Solution</strong>: We use the above R function to evaluate the function at the two given nodes.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="newton-interpolation.html#cb164-1" tabindex="-1"></a>pred.<span class="fl">1.6</span> <span class="ot">=</span> <span class="fu">NewtonInterpolation</span>(<span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb164-2"><a href="newton-interpolation.html#cb164-2" tabindex="-1"></a>                    <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>), </span>
<span id="cb164-3"><a href="newton-interpolation.html#cb164-3" tabindex="-1"></a>                    <span class="at">pred.x =</span> <span class="fl">1.6</span>)</span>
<span id="cb164-4"><a href="newton-interpolation.html#cb164-4" tabindex="-1"></a>pred.<span class="fl">1.1</span> <span class="ot">=</span> <span class="fu">NewtonInterpolation</span>(<span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb164-5"><a href="newton-interpolation.html#cb164-5" tabindex="-1"></a>                    <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>), </span>
<span id="cb164-6"><a href="newton-interpolation.html#cb164-6" tabindex="-1"></a>                    <span class="at">pred.x =</span> <span class="fl">1.1</span>)</span>
<span id="cb164-7"><a href="newton-interpolation.html#cb164-7" tabindex="-1"></a>pred.<span class="fl">2.0</span> <span class="ot">=</span> <span class="fu">NewtonInterpolation</span>(<span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb164-8"><a href="newton-interpolation.html#cb164-8" tabindex="-1"></a>                    <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>), </span>
<span id="cb164-9"><a href="newton-interpolation.html#cb164-9" tabindex="-1"></a>                    <span class="at">pred.x =</span> <span class="fl">2.0</span>)</span>
<span id="cb164-10"><a href="newton-interpolation.html#cb164-10" tabindex="-1"></a></span>
<span id="cb164-11"><a href="newton-interpolation.html#cb164-11" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">cbind</span>(<span class="at">pred.1.6=</span>pred.<span class="fl">1.6</span>, <span class="at">pred.1.1=</span>pred.<span class="fl">1.1</span>, <span class="at">pred.2.0 =</span> pred.<span class="fl">2.0</span>))</span></code></pre></div>
<table style="width:46%;">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">pred.1.6</th>
<th align="center">pred.1.1</th>
<th align="center">pred.2.0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.4554</td>
<td align="center">0.7196</td>
<td align="center">0.2239</td>
</tr>
</tbody>
</table>
<p>The results are the same as those obtained in the textbook Burden and Faires (9th edition, page 131).</p>
<p><strong>R Function: Vector Enabled Newton Interpolated Polynomial</strong></p>
<p>Next, we modify the previous R function to take a vector of input x-values for prediction just like other R functions.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="newton-interpolation.html#cb165-1" tabindex="-1"></a><span class="do">##################################################################################</span></span>
<span id="cb165-2"><a href="newton-interpolation.html#cb165-2" tabindex="-1"></a><span class="do">##  Newton Interpolated Polynomial Approximation: vector-enabled input</span></span>
<span id="cb165-3"><a href="newton-interpolation.html#cb165-3" tabindex="-1"></a><span class="do">##################################################################################</span></span>
<span id="cb165-4"><a href="newton-interpolation.html#cb165-4" tabindex="-1"></a></span>
<span id="cb165-5"><a href="newton-interpolation.html#cb165-5" tabindex="-1"></a>Newton.Interpolation <span class="ot">=</span> <span class="cf">function</span>( vec.x,            <span class="co"># input interpolation nodes</span></span>
<span id="cb165-6"><a href="newton-interpolation.html#cb165-6" tabindex="-1"></a>                                <span class="at">vec.y =</span> <span class="cn">NULL</span>,    </span>
<span id="cb165-7"><a href="newton-interpolation.html#cb165-7" tabindex="-1"></a>                                <span class="at">fn =</span> <span class="cn">NULL</span>,        <span class="co"># either vec.y or fn must be provided</span></span>
<span id="cb165-8"><a href="newton-interpolation.html#cb165-8" tabindex="-1"></a>                                pred.x            <span class="co"># VECTOR INPUT!!!</span></span>
<span id="cb165-9"><a href="newton-interpolation.html#cb165-9" tabindex="-1"></a>                              ){</span>
<span id="cb165-10"><a href="newton-interpolation.html#cb165-10" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">length</span>(vec.y) <span class="sc">==</span><span class="dv">0</span>) vec.y <span class="ot">=</span> <span class="fu">fn</span>(vec.x)</span>
<span id="cb165-11"><a href="newton-interpolation.html#cb165-11" tabindex="-1"></a>   DivDif <span class="ot">=</span> <span class="fu">Divided.Dif</span>(vec.x, vec.y)[,<span class="dv">1</span>]       <span class="co"># the values in the first column of the div dif matrix</span></span>
<span id="cb165-12"><a href="newton-interpolation.html#cb165-12" tabindex="-1"></a>   n <span class="ot">=</span> <span class="fu">length</span>(vec.x)</span>
<span id="cb165-13"><a href="newton-interpolation.html#cb165-13" tabindex="-1"></a>   <span class="do">############</span></span>
<span id="cb165-14"><a href="newton-interpolation.html#cb165-14" tabindex="-1"></a>   m <span class="ot">=</span> <span class="fu">length</span>(pred.x)</span>
<span id="cb165-15"><a href="newton-interpolation.html#cb165-15" tabindex="-1"></a>   NV <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)                 <span class="co"># values of Nn(pred.x)</span></span>
<span id="cb165-16"><a href="newton-interpolation.html#cb165-16" tabindex="-1"></a>   <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb165-17"><a href="newton-interpolation.html#cb165-17" tabindex="-1"></a>   <span class="do">################</span></span>
<span id="cb165-18"><a href="newton-interpolation.html#cb165-18" tabindex="-1"></a>   Nn <span class="ot">=</span> vec.y[<span class="dv">1</span>]                  <span class="co"># f[xo]</span></span>
<span id="cb165-19"><a href="newton-interpolation.html#cb165-19" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){            <span class="co"># Must be n - 1 according to the last term in the polynomial</span></span>
<span id="cb165-20"><a href="newton-interpolation.html#cb165-20" tabindex="-1"></a>     cumProd <span class="ot">=</span> <span class="dv">1</span>                  <span class="co"># initial value to calculate the cumulative product</span></span>
<span id="cb165-21"><a href="newton-interpolation.html#cb165-21" tabindex="-1"></a>     <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>i){               <span class="co"># forward difference formula</span></span>
<span id="cb165-22"><a href="newton-interpolation.html#cb165-22" tabindex="-1"></a>       cumProd <span class="ot">=</span> cumProd<span class="sc">*</span>(pred.x[k]<span class="sc">-</span>vec.x[j])   <span class="co"># updating the cumulative product in the inner loop</span></span>
<span id="cb165-23"><a href="newton-interpolation.html#cb165-23" tabindex="-1"></a>     }</span>
<span id="cb165-24"><a href="newton-interpolation.html#cb165-24" tabindex="-1"></a>      Nn <span class="ot">=</span> Nn <span class="sc">+</span> DivDif[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">*</span>cumProd    <span class="co"># adding high order terms alliteratively to the Nn(x) </span></span>
<span id="cb165-25"><a href="newton-interpolation.html#cb165-25" tabindex="-1"></a>    }</span>
<span id="cb165-26"><a href="newton-interpolation.html#cb165-26" tabindex="-1"></a>    NV[k] <span class="ot">=</span> Nn                                  <span class="co"># return the value the Newton polynomial</span></span>
<span id="cb165-27"><a href="newton-interpolation.html#cb165-27" tabindex="-1"></a>   }</span>
<span id="cb165-28"><a href="newton-interpolation.html#cb165-28" tabindex="-1"></a> NV  </span>
<span id="cb165-29"><a href="newton-interpolation.html#cb165-29" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="newton-interpolation.html#cb166-1" tabindex="-1"></a>pred.x <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">2.0</span>)   <span class="co"># pred.x is the argument is a local variable!</span></span>
<span id="cb166-2"><a href="newton-interpolation.html#cb166-2" tabindex="-1"></a>pred.NIP <span class="ot">=</span> <span class="fu">Newton.Interpolation</span>(<span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb166-3"><a href="newton-interpolation.html#cb166-3" tabindex="-1"></a>                    <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>), </span>
<span id="cb166-4"><a href="newton-interpolation.html#cb166-4" tabindex="-1"></a>                    <span class="at">pred.x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">2.0</span>))</span>
<span id="cb166-5"><a href="newton-interpolation.html#cb166-5" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">cbind</span>(<span class="at">pred.x =</span> pred.x, <span class="at">pred.NIP=</span>pred.NIP))</span></code></pre></div>
<table style="width:28%;">
<colgroup>
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">pred.x</th>
<th align="center">pred.NIP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.6</td>
<td align="center">0.4554</td>
</tr>
<tr class="even">
<td align="center">1.1</td>
<td align="center">0.7196</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">0.2239</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="error-analysis-6" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Error Analysis<a href="newton-interpolation.html#error-analysis-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using the generalized Rolle theorem repeatedly on the expression of the divided difference, have the following result.</p>
<p><strong>Theorem</strong>: Let <span class="math inline">\(x_0, \cdots , x_{n-1}\)</span>, <span class="math inline">\(x\)</span> be <span class="math inline">\(n+1\)</span> distinct points. Let <span class="math inline">\(a = \min (x_0, \cdots , x_{n-1}, x)\)</span> and <span class="math inline">\(b = \max(x_0, \cdots , x_{n-1},x)\)</span>. Assume that <span class="math inline">\(f(x)\)</span> has a continuous derivative of order <span class="math inline">\(n\)</span> in the interval <span class="math inline">\((a, b)\)</span>. Then</p>
<p><span class="math display">\[
f[x_0, x_1, \cdots, x_{n-1}, x] = \frac{f^{(n)}(\xi)}{n!}
\]</span></p>
<p>where <span class="math inline">\(\xi \in (a, b)\)</span>.</p>
<p><strong>Proof</strong>: Let <span class="math inline">\(P_{n+1}(y)\)</span> be the interpolated polynomial at <span class="math inline">\(y\)</span> for given nodes <span class="math inline">\(\{ x_0, x_1, x_2, \cdots, x_{n-1},x \}\)</span> such that <span class="math inline">\(P_{n+1}(x_i) = f(x_i)\)</span> for <span class="math inline">\(i = 0, 1, 2, \cdots, n-1\)</span>, and <span class="math inline">\(P_{n+1}(x) = f(x)\)</span>. From the construction of Newton interpolating polynomial <span class="math inline">\(P_n(x)\)</span>, we know that
<span class="math display">\[
P_n(y) = P_{n-1}(x) + f[x_0, x_1, x_2, \cdots, x_{n-1},x] (x-x_0)\cdots(x-x_{n-1})
\]</span>
Apparently,</p>
<p><span class="math display">\[
f(x) =P_n(x) = P_{n-1}(x) + f[x0, x1, x2, \cdots, x_{n-1},x] (x-x_0)\cdots(x-x_{n-1})
\]</span>
Using the theorem introduced in the last unit and the uniqueness of the app, we have</p>
<p><span class="math display">\[
f(x) = P_{n-1}(x) + \frac{f^{(n)}(\xi)}{n!}(x-x_0)(x-x_1)\cdots(x-x_{n-1}).
\]</span></p>
<p>Using the same arguments in the Lagrange interpolation polynomial, we can establish the error bound for the Newton form interpolation polynomials.</p>
</div>
<div id="some-remarks-of-newton-interpolation" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Some Remarks of Newton Interpolation<a href="newton-interpolation.html#some-remarks-of-newton-interpolation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First of all, both Lagrange and Newton interpolation polynomials introduced earlier can be viewed as a linear combination of basis polynomials <span class="math inline">\(\{x^0, x^1, x^2, x^2, \cdots, x^n \}\)</span>. In fact, Lagrange and Newton interpolation polynomials are two different algebraic representations of the same polynomial.</p>
<p>That is, <span class="math inline">\(P_n(x)\)</span> and <span class="math inline">\(N_n(x)\)</span> be Lagrange and Newton interpolation polynomials based on <span class="math inline">\((x_0, y_0), (x_1, y_1), (x_2, y_2), \cdots, (x_n, y_n)\)</span>. We express both <span class="math inline">\(P_n(x)\)</span> and <span class="math inline">\(N_n(x)\)</span> in terms of basis polynomials <span class="math inline">\(\{x^0, x^1, x^2, x^2, \cdots, x^n \}\)</span> as</p>
<p><span class="math display">\[
P_n(x) = a_0 + a_1x + a_2x^2 + \cdots + a_nx^n \ \ \text{ and } \ \ N_n(x) = b_0 + b_1x + b_2x^2 + \cdots + b_nx^n
\]</span>
Since <span class="math inline">\(P_n(x_i) = y_i = N_n(x_i)\)</span> for <span class="math inline">\(i = x_0, x_1, \cdots, x_n\)</span>, we can easily show that <span class="math inline">\(a_j = b_j\)</span> for <span class="math inline">\(j = 0, 1, 2, \cdots, n\)</span>. Therefore, the error bounds of both Lagrange and Newton interpolation polynomials are the same.</p>
<p>For the Newton form interpolation polynomial, we only need to add more terms if additional interpolation nodes are added to the existing ones. Since the divided differences are independent of the newly added nodes. But for the Lagrange form, we need to restart the program. This is a unique feature of the Newton interpolation polynomial.</p>
<p><strong>Example 4</strong>. Use the Newton Interpolation polynomial to approximate <span class="math inline">\(f(x) = \sin(x)\)</span> with interpolating nodes <span class="math inline">\(x = -\pi, -0.75\pi, -0.5\pi, 0.25\pi, 0, 0.25\pi, 0.5\pi, 0.75\pi, \pi\)</span>.</p>
<p><strong>Solution</strong>: We plot both <span class="math inline">\(f(x) = \sin(x)\)</span> and <span class="math inline">\(N_8(x)\)</span> over interval <span class="math inline">\([-2\pi, 2\pi]\)</span> and see the performance of the approximation.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="newton-interpolation.html#cb167-1" tabindex="-1"></a>nodes <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span>pi, <span class="sc">-</span>pi, <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>pi, <span class="sc">-</span><span class="fl">0.25</span><span class="sc">*</span>pi, <span class="dv">0</span>, <span class="fl">0.25</span><span class="sc">*</span>pi, <span class="fl">0.5</span><span class="sc">*</span>pi,  pi, <span class="fl">1.5</span><span class="sc">*</span>pi)</span>
<span id="cb167-2"><a href="newton-interpolation.html#cb167-2" tabindex="-1"></a><span class="do">####</span></span>
<span id="cb167-3"><a href="newton-interpolation.html#cb167-3" tabindex="-1"></a>xx <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length =</span> <span class="dv">50</span>)</span>
<span id="cb167-4"><a href="newton-interpolation.html#cb167-4" tabindex="-1"></a>yy <span class="ot">=</span> <span class="fu">sin</span>(xx)</span>
<span id="cb167-5"><a href="newton-interpolation.html#cb167-5" tabindex="-1"></a>Nn <span class="ot">=</span> <span class="fu">Newton.Interpolation</span>(<span class="at">vec.x =</span> nodes,           </span>
<span id="cb167-6"><a href="newton-interpolation.html#cb167-6" tabindex="-1"></a>                    <span class="at">vec.y =</span> <span class="fu">sin</span>(nodes), </span>
<span id="cb167-7"><a href="newton-interpolation.html#cb167-7" tabindex="-1"></a>                    <span class="at">pred.x =</span> xx)</span>
<span id="cb167-8"><a href="newton-interpolation.html#cb167-8" tabindex="-1"></a><span class="fu">plot</span>(xx, Nn, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb167-9"><a href="newton-interpolation.html#cb167-9" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Newton Interpolation Polynomial&quot;</span>)</span>
<span id="cb167-10"><a href="newton-interpolation.html#cb167-10" tabindex="-1"></a><span class="fu">lines</span>(xx, yy, <span class="at">lty =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-11"><a href="newton-interpolation.html#cb167-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="MAT325EB_files/figure-html/unnamed-chunk-103-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="implicit-loops-in-r-programming" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Implicit Loops in R Programming<a href="newton-interpolation.html#implicit-loops-in-r-programming" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This lab note introduces how to reduce loops through vectorization. For any vectorized language, there are different extensions such as user-defined functions and routines to carry vectorized operation instead of element-wise operation. Most R functions are vectorized. We will use some examples to illustrate how a loop can be avoided if vectorization is available.</p>
<p><br />
</p>
<div id="implicit-in-r-primitive-functions" class="section level3 hasAnchor" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Implicit in R Primitive Functions<a href="newton-interpolation.html#implicit-in-r-primitive-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R was written in C. It has a long list of primitive functions written in C. Most of these functions are vectorized. Calling an internal vectorized function is the same as performing an implicit loop.</p>
<p><strong>Example 1</strong>: Consider the sum of two matrices with the same dimension. Define</p>
<p><span class="math display">\[
A = \begin{pmatrix}
1 &amp; 2 &amp; 3\\
3 &amp; 7 &amp; 9
\end{pmatrix}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
B = \begin{pmatrix}
5 &amp; 2 &amp; 7\\
4 &amp; 1 &amp; 6
\end{pmatrix}
\]</span></p>
<p>We find the sum of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span></p>
<p><span class="math display">\[
A + B = \begin{pmatrix}
6 &amp; 4 &amp; 10\\
7 &amp; 8 &amp; 15
\end{pmatrix}
\]</span></p>
<p><strong>Method 1</strong>: Using explicit loops. Since the sum of compatible matrices is an element-wise operation, in order to access individual elements, we need to use two indexes - one for the row and one for the column. We use the double loops to calculate the sum of two matrices in the following code.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="newton-interpolation.html#cb168-1" tabindex="-1"></a>loopSum <span class="ot">=</span> <span class="cf">function</span>(A,B){</span>
<span id="cb168-2"><a href="newton-interpolation.html#cb168-2" tabindex="-1"></a>    sumAB <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(A)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(A)[<span class="dv">2</span>])</span>
<span id="cb168-3"><a href="newton-interpolation.html#cb168-3" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(A)[<span class="dv">1</span>]) {</span>
<span id="cb168-4"><a href="newton-interpolation.html#cb168-4" tabindex="-1"></a>            <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(A)[<span class="dv">2</span>]){</span>
<span id="cb168-5"><a href="newton-interpolation.html#cb168-5" tabindex="-1"></a>                sumAB[i,j] <span class="ot">=</span> A[i,j] <span class="sc">+</span> B[i,j]</span>
<span id="cb168-6"><a href="newton-interpolation.html#cb168-6" tabindex="-1"></a>             }</span>
<span id="cb168-7"><a href="newton-interpolation.html#cb168-7" tabindex="-1"></a>         }</span>
<span id="cb168-8"><a href="newton-interpolation.html#cb168-8" tabindex="-1"></a>    sumAB</span>
<span id="cb168-9"><a href="newton-interpolation.html#cb168-9" tabindex="-1"></a> }</span></code></pre></div>
<p>We can also use R primitive function <code>+</code> to perform the matrix summation.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="newton-interpolation.html#cb169-1" tabindex="-1"></a>vectorSum <span class="ot">=</span> <span class="cf">function</span>(A,B) {A <span class="sc">+</span> B}</span></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="newton-interpolation.html#cb170-1" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">9</span>), <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb170-2"><a href="newton-interpolation.html#cb170-2" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">6</span>), <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="newton-interpolation.html#cb171-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb171-2"><a href="newton-interpolation.html#cb171-2" tabindex="-1"></a><span class="fu">loopSum</span>(A,B)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    6    4   10
## [2,]    7    8   15</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="newton-interpolation.html#cb173-1" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code></pre></div>
<pre><code>## Time difference of 0.01857495 secs</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="newton-interpolation.html#cb175-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb175-2"><a href="newton-interpolation.html#cb175-2" tabindex="-1"></a><span class="fu">vectorSum</span>(A,B)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    6    4   10
## [2,]    7    8   15</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="newton-interpolation.html#cb177-1" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code></pre></div>
<pre><code>## Time difference of 0.007112026 secs</code></pre>
<p><strong>Example 2</strong>: Summation of large matrices.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="newton-interpolation.html#cb179-1" tabindex="-1"></a>A0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">10000000</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb179-2"><a href="newton-interpolation.html#cb179-2" tabindex="-1"></a>B0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">10000000</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="newton-interpolation.html#cb180-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb180-2"><a href="newton-interpolation.html#cb180-2" tabindex="-1"></a>AplusB.lp <span class="ot">=</span> <span class="fu">loopSum</span>(A0,B0)</span>
<span id="cb180-3"><a href="newton-interpolation.html#cb180-3" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code></pre></div>
<pre><code>## Time difference of 1.088036 secs</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="newton-interpolation.html#cb182-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb182-2"><a href="newton-interpolation.html#cb182-2" tabindex="-1"></a>AplusB.vec <span class="ot">=</span> <span class="fu">vectorSum</span>(A0,B0)</span>
<span id="cb182-3"><a href="newton-interpolation.html#cb182-3" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code></pre></div>
<pre><code>## Time difference of 0.1479499 secs</code></pre>
<p>The obvious benefits of using an implicit vectorized primitive function to perform matrix operation:</p>
<ol style="list-style-type: decimal">
<li><p>The code is simple.</p></li>
<li><p>It is faster.</p></li>
</ol>
</div>
<div id="some-vectorized-primitive-functions" class="section level3 hasAnchor" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Some Vectorized Primitive Functions<a href="newton-interpolation.html#some-vectorized-primitive-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the numerator and denominator are defined as the difference between adjacent terms. We can vectorize these differences using the R function <strong>diff()</strong> that computes the difference between pairs of consecutive elements of a numeric vector.</p>
<p><strong>Example 2</strong>: Consider <code>vec.x = (1, 1.3, 1.6, 1.9, 2.2)</code> and <code>vec.y = (0.7651977, 0.6200860, 0.4554022, 0.2818186, 0.1103623)</code>. We use the <strong>diff()</strong> to calculate the divided differences in the following table step by step.</p>
<p><img src="img06/w06-DividedDifferenceTableExample.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The following are manual steps for calculating the divided differences in the above table.</p>
<ul>
<li><em>Step 1</em>: zero-th order divided differences (<span class="math inline">\(i = 1\)</span>)</li>
</ul>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="newton-interpolation.html#cb184-1" tabindex="-1"></a>vec.x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>)          </span>
<span id="cb184-2"><a href="newton-interpolation.html#cb184-2" tabindex="-1"></a>vec.y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb184-3"><a href="newton-interpolation.html#cb184-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(vec.x)</span></code></pre></div>
<ul>
<li><em>Step 2</em>: The first order divided differences (i = 2)</li>
</ul>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="newton-interpolation.html#cb185-1" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb185-2"><a href="newton-interpolation.html#cb185-2" tabindex="-1"></a><span class="do">## divided difference</span></span>
<span id="cb185-3"><a href="newton-interpolation.html#cb185-3" tabindex="-1"></a>i2.y <span class="ot">=</span> <span class="fu">diff</span>(vec.y)</span>
<span id="cb185-4"><a href="newton-interpolation.html#cb185-4" tabindex="-1"></a>i2.x <span class="ot">=</span> vec.x[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>))] <span class="sc">-</span> vec.x[<span class="sc">-</span>((n<span class="sc">+</span><span class="dv">2</span><span class="sc">-</span>i)<span class="sc">:</span>n)]</span>
<span id="cb185-5"><a href="newton-interpolation.html#cb185-5" tabindex="-1"></a>i2.divDif <span class="ot">=</span> i2.y<span class="sc">/</span>i2.x</span>
<span id="cb185-6"><a href="newton-interpolation.html#cb185-6" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">i2.y =</span> i2.y, <span class="at">i2.x =</span> i2.x, <span class="at">i2.divDif =</span> i2.divDif)</span></code></pre></div>
<pre><code>##      i2.y i2.x i2.divDif
## [1,]   -4   -2      2.00
## [2,]    5    4      1.25
## [3,]    2    1      2.00</code></pre>
<ul>
<li><em>Step 3</em>: The first order divided differences (i = 3)</li>
</ul>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="newton-interpolation.html#cb187-1" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb187-2"><a href="newton-interpolation.html#cb187-2" tabindex="-1"></a>i3.y <span class="ot">=</span> <span class="fu">diff</span>(i2.divDif)    <span class="co"># Caution </span></span>
<span id="cb187-3"><a href="newton-interpolation.html#cb187-3" tabindex="-1"></a>i3.x <span class="ot">=</span> vec.x[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>))] <span class="sc">-</span> vec.x[<span class="sc">-</span>((n<span class="sc">+</span><span class="dv">2</span><span class="sc">-</span>i)<span class="sc">:</span>n)]</span>
<span id="cb187-4"><a href="newton-interpolation.html#cb187-4" tabindex="-1"></a>i3.divDif <span class="ot">=</span> i3.y<span class="sc">/</span>i3.x</span>
<span id="cb187-5"><a href="newton-interpolation.html#cb187-5" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">i3.y =</span> i3.y, <span class="at">i3.x =</span> i3.x, <span class="at">i3.divDif =</span> i3.divDif)</span></code></pre></div>
<pre><code>##       i3.y i3.x i3.divDif
## [1,] -0.75    2    -0.375
## [2,]  0.75    5     0.150</code></pre>
<ul>
<li><em>Step 4</em>: The first order divided differences (i = 4)</li>
</ul>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="newton-interpolation.html#cb189-1" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb189-2"><a href="newton-interpolation.html#cb189-2" tabindex="-1"></a>i4.y <span class="ot">=</span> <span class="fu">diff</span>(i3.divDif)            </span>
<span id="cb189-3"><a href="newton-interpolation.html#cb189-3" tabindex="-1"></a>i4.x <span class="ot">=</span> vec.x[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>))] <span class="sc">-</span> vec.x[<span class="sc">-</span>((n<span class="sc">+</span><span class="dv">2-4</span>)<span class="sc">:</span>n)]</span>
<span id="cb189-4"><a href="newton-interpolation.html#cb189-4" tabindex="-1"></a>i4.divDif <span class="ot">=</span> i4.y<span class="sc">/</span>i4.x</span>
<span id="cb189-5"><a href="newton-interpolation.html#cb189-5" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">i4.y =</span> i4.y, <span class="at">i4.x =</span> i4.x, <span class="at">i4.divDif =</span> i4.divDif)</span></code></pre></div>
<pre><code>##       i4.y i4.x i4.divDif
## [1,] 0.525    3     0.175</code></pre>
</div>
<div id="divided-difference-variants" class="section level3 hasAnchor" number="11.5.3">
<h3><span class="header-section-number">11.5.3</span> Divided Difference Variants<a href="newton-interpolation.html#divided-difference-variants" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall the definitions of the divided difference in the Newton form interpolation.</p>
<p><span class="math display">\[
N_n(x) = f[x_0] + f[x_0, x_1](x-x_0) + f[x_0, x_1, x_2](x-x_0)(x-x_1) + \cdots + f[x_0, \cdots, x_n](x-x_0)\cdots(x-x_{n-1})
\]</span></p>
<p><img src="img06/w06-DividedDifferenceTableExtended.png" width="99%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="newton-interpolation.html#cb191-1" tabindex="-1"></a>NewtonInterp <span class="ot">=</span> <span class="cf">function</span>(xvec, </span>
<span id="cb191-2"><a href="newton-interpolation.html#cb191-2" tabindex="-1"></a>                        <span class="at">yvec =</span> <span class="cn">NULL</span>, </span>
<span id="cb191-3"><a href="newton-interpolation.html#cb191-3" tabindex="-1"></a>                        <span class="at">fn =</span> <span class="cn">NULL</span>,</span>
<span id="cb191-4"><a href="newton-interpolation.html#cb191-4" tabindex="-1"></a>                        pred.x</span>
<span id="cb191-5"><a href="newton-interpolation.html#cb191-5" tabindex="-1"></a>                        ){</span>
<span id="cb191-6"><a href="newton-interpolation.html#cb191-6" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">length</span>(yvec)<span class="sc">==</span><span class="dv">0</span>) yvec <span class="ot">=</span> <span class="fu">fn</span>(xvec)</span>
<span id="cb191-7"><a href="newton-interpolation.html#cb191-7" tabindex="-1"></a> n<span class="ot">=</span><span class="fu">length</span>(xvec)</span>
<span id="cb191-8"><a href="newton-interpolation.html#cb191-8" tabindex="-1"></a> DivDiff <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)         <span class="co"># zero vector to store divided differences</span></span>
<span id="cb191-9"><a href="newton-interpolation.html#cb191-9" tabindex="-1"></a> NewtonBasis <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1</span>)     <span class="co"># zero vector to store Newton form basis polynomial </span></span>
<span id="cb191-10"><a href="newton-interpolation.html#cb191-10" tabindex="-1"></a> DivDiff[<span class="dv">1</span>]<span class="ot">=</span>yvec[<span class="dv">1</span>]         <span class="co"># 1st order divided difference loaded to the first</span></span>
<span id="cb191-11"><a href="newton-interpolation.html#cb191-11" tabindex="-1"></a> NewtonBasis[<span class="dv">1</span>]<span class="ot">=</span><span class="dv">1</span>           <span class="co"># zero-degree basis polynomial</span></span>
<span id="cb191-12"><a href="newton-interpolation.html#cb191-12" tabindex="-1"></a> old.NewtonBasis <span class="ot">=</span> <span class="dv">1</span>        <span class="co"># initialize Newton basis polynomial for updating newer basis</span></span>
<span id="cb191-13"><a href="newton-interpolation.html#cb191-13" tabindex="-1"></a> <span class="do">##</span></span>
<span id="cb191-14"><a href="newton-interpolation.html#cb191-14" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb191-15"><a href="newton-interpolation.html#cb191-15" tabindex="-1"></a>    NewtonBasis[i] <span class="ot">=</span> old.NewtonBasis<span class="sc">*</span>(pred.x<span class="sc">-</span>xvec[i<span class="dv">-1</span>])  <span class="co"># updating Basis polynomial   </span></span>
<span id="cb191-16"><a href="newton-interpolation.html#cb191-16" tabindex="-1"></a>    dfx <span class="ot">=</span> xvec[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>))] <span class="sc">-</span> xvec[<span class="sc">-</span>((n<span class="sc">-</span>(i<span class="dv">-2</span>))<span class="sc">:</span>n)]         <span class="co"># denominator in the divided difference</span></span>
<span id="cb191-17"><a href="newton-interpolation.html#cb191-17" tabindex="-1"></a>    dy <span class="ot">=</span> <span class="fu">diff</span>(yvec)              <span class="co"># difference of lower order divided difference for the numerator</span></span>
<span id="cb191-18"><a href="newton-interpolation.html#cb191-18" tabindex="-1"></a>    <span class="do">##        </span></span>
<span id="cb191-19"><a href="newton-interpolation.html#cb191-19" tabindex="-1"></a>    DivForm <span class="ot">=</span> dy<span class="sc">/</span>dfx                   <span class="co"># new vector of divided differences</span></span>
<span id="cb191-20"><a href="newton-interpolation.html#cb191-20" tabindex="-1"></a>    DivDiff[i]<span class="ot">=</span>DivForm[<span class="dv">1</span>]              <span class="co"># pick the top one store in the vector of DivDiff</span></span>
<span id="cb191-21"><a href="newton-interpolation.html#cb191-21" tabindex="-1"></a>    yvec <span class="ot">=</span> DivForm                     <span class="co"># updating for operation in the next row</span></span>
<span id="cb191-22"><a href="newton-interpolation.html#cb191-22" tabindex="-1"></a>    old.NewtonBasis <span class="ot">=</span> NewtonBasis[i]   <span class="co"># updating Newton basis polynomial</span></span>
<span id="cb191-23"><a href="newton-interpolation.html#cb191-23" tabindex="-1"></a>   }</span>
<span id="cb191-24"><a href="newton-interpolation.html#cb191-24" tabindex="-1"></a> Nx<span class="ot">=</span><span class="fu">sum</span>(DivDiff<span class="sc">*</span>NewtonBasis)           <span class="co"># predicted y value of the given pred.x</span></span>
<span id="cb191-25"><a href="newton-interpolation.html#cb191-25" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">Pred.y =</span> Nx, <span class="at">DividedDifference =</span> DivDiff, <span class="at">NewtonBasis =</span> NewtonBasis)</span>
<span id="cb191-26"><a href="newton-interpolation.html#cb191-26" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Example 3</strong>: Reproduce the result in the above illustrative table.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="newton-interpolation.html#cb192-1" tabindex="-1"></a>vec.x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>)          </span>
<span id="cb192-2"><a href="newton-interpolation.html#cb192-2" tabindex="-1"></a>vec.y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb192-3"><a href="newton-interpolation.html#cb192-3" tabindex="-1"></a>example1 <span class="ot">=</span> <span class="fu">NewtonInterp</span>(<span class="at">yvec =</span> vec.y, <span class="at">xvec =</span> vec.x, <span class="at">pred.x =</span> <span class="dv">5</span>)</span>
<span id="cb192-4"><a href="newton-interpolation.html#cb192-4" tabindex="-1"></a>example1</span></code></pre></div>
<pre><code>## $Pred.y
## [1] 2
## 
## $DividedDifference
## [1]  1.000  2.000 -0.375  0.175
## 
## $NewtonBasis
## [1] 1 2 8 0</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="newton-interpolation.html#cb194-1" tabindex="-1"></a><span class="fu">sum</span>(example1<span class="sc">$</span>DividedDifferenc<span class="sc">*</span> example1<span class="sc">$</span>NewtonBasis)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p><strong>Example 5</strong>: Reproduce <em>Example 1</em> of Burden and Faires’ textbook, 9th edition, page 127) Complete the divided difference table for the following data.</p>
<table style="width:19%;">
<colgroup>
<col width="5%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.0
1.3
1.6
1.9
2.2</td>
<td align="center">0.7651977
0.6200860
0.4554022
0.2818186
0.1103623</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="newton-interpolation.html#cb196-1" tabindex="-1"></a>vec.x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>)          </span>
<span id="cb196-2"><a href="newton-interpolation.html#cb196-2" tabindex="-1"></a>vec.y <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>)</span>
<span id="cb196-3"><a href="newton-interpolation.html#cb196-3" tabindex="-1"></a>example2 <span class="ot">=</span> <span class="fu">NewtonInterp</span>(<span class="at">yvec =</span> vec.y, <span class="at">xvec =</span> vec.x, <span class="at">pred.x =</span> <span class="dv">1</span>)</span>
<span id="cb196-4"><a href="newton-interpolation.html#cb196-4" tabindex="-1"></a>example2</span></code></pre></div>
<pre><code>## $Pred.y
## [1] 0.7651977
## 
## $DividedDifference
## [1]  0.765197700 -0.483705667 -0.108733889  0.065878395  0.001825103
## 
## $NewtonBasis
## [1] 1 0 0 0 0</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="newton-interpolation.html#cb198-1" tabindex="-1"></a><span class="fu">sum</span>(example2<span class="sc">$</span>DividedDifferenc<span class="sc">*</span> example2<span class="sc">$</span>NewtonBasis)</span></code></pre></div>
<pre><code>## [1] 0.7651977</code></pre>
</div>
<div id="vectorizing-newtoninterp" class="section level3 hasAnchor" number="11.5.4">
<h3><span class="header-section-number">11.5.4</span> Vectorizing <strong>NewtonInterp()</strong><a href="newton-interpolation.html#vectorizing-newtoninterp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we vectorize the above R function for Newton interpolation polynomial so that it can take a vector input. We will also compare this new function with the two R functions created in the lecture note.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="newton-interpolation.html#cb200-1" tabindex="-1"></a>Vectorizing.Newton <span class="ot">=</span> <span class="cf">function</span>(xvec, </span>
<span id="cb200-2"><a href="newton-interpolation.html#cb200-2" tabindex="-1"></a>                                <span class="at">yvec =</span> <span class="cn">NULL</span>, </span>
<span id="cb200-3"><a href="newton-interpolation.html#cb200-3" tabindex="-1"></a>                                <span class="at">fn =</span> <span class="cn">NULL</span>,</span>
<span id="cb200-4"><a href="newton-interpolation.html#cb200-4" tabindex="-1"></a>                                pred.x     <span class="co"># numerical vector or scalar input</span></span>
<span id="cb200-5"><a href="newton-interpolation.html#cb200-5" tabindex="-1"></a>                        ){</span>
<span id="cb200-6"><a href="newton-interpolation.html#cb200-6" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">length</span>(yvec) <span class="sc">==</span> <span class="dv">0</span>) yvec <span class="ot">=</span> <span class="fu">fn</span>(xvec)</span>
<span id="cb200-7"><a href="newton-interpolation.html#cb200-7" tabindex="-1"></a> n <span class="ot">=</span> <span class="fu">length</span>(xvec)  </span>
<span id="cb200-8"><a href="newton-interpolation.html#cb200-8" tabindex="-1"></a> m <span class="ot">=</span> <span class="fu">length</span>(pred.x)            <span class="co"># dimension of the input vector for prediction</span></span>
<span id="cb200-9"><a href="newton-interpolation.html#cb200-9" tabindex="-1"></a> NewtonPolynomial <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)  <span class="co"># predicted value of the Newton interpolation polynomial</span></span>
<span id="cb200-10"><a href="newton-interpolation.html#cb200-10" tabindex="-1"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb200-11"><a href="newton-interpolation.html#cb200-11" tabindex="-1"></a>    yvec0 <span class="ot">=</span> yvec     <span class="co"># </span><span class="al">CAUTION</span><span class="co">: Must be REINSTATED! diff(yvec) will change its original values!! </span></span>
<span id="cb200-12"><a href="newton-interpolation.html#cb200-12" tabindex="-1"></a>    DivDiff <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)         <span class="co"># zero vector to store divided differences</span></span>
<span id="cb200-13"><a href="newton-interpolation.html#cb200-13" tabindex="-1"></a>    NewtonBasis <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1</span>)     <span class="co"># zero vector to store Newton form basis polynomial </span></span>
<span id="cb200-14"><a href="newton-interpolation.html#cb200-14" tabindex="-1"></a>    DivDiff[<span class="dv">1</span>] <span class="ot">=</span> yvec[<span class="dv">1</span>]       <span class="co"># 1st order divided difference loaded to the first</span></span>
<span id="cb200-15"><a href="newton-interpolation.html#cb200-15" tabindex="-1"></a>    NewtonBasis[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span>         <span class="co"># zero-degree basis polynomial</span></span>
<span id="cb200-16"><a href="newton-interpolation.html#cb200-16" tabindex="-1"></a>    old.NewtonBasis <span class="ot">=</span> <span class="dv">1</span>        <span class="co"># initialize Newton basis polynomial for updating the newer basis</span></span>
<span id="cb200-17"><a href="newton-interpolation.html#cb200-17" tabindex="-1"></a>    <span class="do">##</span></span>
<span id="cb200-18"><a href="newton-interpolation.html#cb200-18" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb200-19"><a href="newton-interpolation.html#cb200-19" tabindex="-1"></a>       NewtonBasis[i] <span class="ot">=</span> old.NewtonBasis<span class="sc">*</span>(pred.x[k]<span class="sc">-</span>xvec[i<span class="dv">-1</span>])  <span class="co"># updating basis polynomial   </span></span>
<span id="cb200-20"><a href="newton-interpolation.html#cb200-20" tabindex="-1"></a>       dfx <span class="ot">=</span> xvec[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>))] <span class="sc">-</span> xvec[<span class="sc">-</span>((n<span class="sc">-</span>(i<span class="dv">-2</span>))<span class="sc">:</span>n)]     <span class="co"># denominator in the divided difference</span></span>
<span id="cb200-21"><a href="newton-interpolation.html#cb200-21" tabindex="-1"></a>       dy <span class="ot">=</span> <span class="fu">diff</span>(yvec0)         <span class="co"># difference of lower order divided difference for the numerator</span></span>
<span id="cb200-22"><a href="newton-interpolation.html#cb200-22" tabindex="-1"></a>       DivForm <span class="ot">=</span> dy<span class="sc">/</span>dfx         <span class="co"># new vector of divided differences</span></span>
<span id="cb200-23"><a href="newton-interpolation.html#cb200-23" tabindex="-1"></a>       <span class="co">#cat(&quot;\n\n Inner loop:&quot;,i,&quot;. dfx =&quot;,dfx, &quot;. dy =&quot;, dy, &quot;. &quot;)</span></span>
<span id="cb200-24"><a href="newton-interpolation.html#cb200-24" tabindex="-1"></a>       DivDiff[i] <span class="ot">=</span> DivForm[<span class="dv">1</span>]  <span class="co"># pick 1st component to store in vector DivDiff</span></span>
<span id="cb200-25"><a href="newton-interpolation.html#cb200-25" tabindex="-1"></a>       yvec0 <span class="ot">=</span> DivForm          <span class="co"># updating for operation in the next row</span></span>
<span id="cb200-26"><a href="newton-interpolation.html#cb200-26" tabindex="-1"></a>       old.NewtonBasis <span class="ot">=</span> NewtonBasis[i]</span>
<span id="cb200-27"><a href="newton-interpolation.html#cb200-27" tabindex="-1"></a>      }</span>
<span id="cb200-28"><a href="newton-interpolation.html#cb200-28" tabindex="-1"></a>      NewtonPolynomial[k] <span class="ot">=</span> <span class="fu">sum</span>(DivDiff<span class="sc">*</span>NewtonBasis)</span>
<span id="cb200-29"><a href="newton-interpolation.html#cb200-29" tabindex="-1"></a>      <span class="co">#cat(&quot;\n\n&quot;,k,&quot;-th Pred.y:&quot;,NewtonPolynomial,&quot;, Diff:&quot;, DivDiff, &quot;, Basis:&quot;, NewtonBasis,&quot;.&quot;)</span></span>
<span id="cb200-30"><a href="newton-interpolation.html#cb200-30" tabindex="-1"></a>     }</span>
<span id="cb200-31"><a href="newton-interpolation.html#cb200-31" tabindex="-1"></a> NewtonPolynomial</span>
<span id="cb200-32"><a href="newton-interpolation.html#cb200-32" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="newton-interpolation.html#cb201-1" tabindex="-1"></a>vec.x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>)          </span>
<span id="cb201-2"><a href="newton-interpolation.html#cb201-2" tabindex="-1"></a>vec.y <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>)</span>
<span id="cb201-3"><a href="newton-interpolation.html#cb201-3" tabindex="-1"></a><span class="fu">Vectorizing.Newton</span>(<span class="at">yvec =</span> vec.y, <span class="at">xvec =</span> vec.x, <span class="at">pred.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.7651977 0.2238754</code></pre>
</div>
<div id="code-efficiency-with-implivit-loops" class="section level3 hasAnchor" number="11.5.5">
<h3><span class="header-section-number">11.5.5</span> Code Efficiency with Implivit Loops<a href="newton-interpolation.html#code-efficiency-with-implivit-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For comparison, we copy the two functions in the lecture note.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="newton-interpolation.html#cb203-1" tabindex="-1"></a>Divided.Dif <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb203-2"><a href="newton-interpolation.html#cb203-2" tabindex="-1"></a>        vec.x,          <span class="co"># input nodes:</span></span>
<span id="cb203-3"><a href="newton-interpolation.html#cb203-3" tabindex="-1"></a>        <span class="at">vec.y =</span> <span class="cn">NULL</span>,   <span class="co"># one of vec.y and fn must be given</span></span>
<span id="cb203-4"><a href="newton-interpolation.html#cb203-4" tabindex="-1"></a>        <span class="at">fn =</span> <span class="cn">NULL</span>,</span>
<span id="cb203-5"><a href="newton-interpolation.html#cb203-5" tabindex="-1"></a>        pred.x          <span class="co"># scalar x for predicting pn(pred.x)</span></span>
<span id="cb203-6"><a href="newton-interpolation.html#cb203-6" tabindex="-1"></a>         ){</span>
<span id="cb203-7"><a href="newton-interpolation.html#cb203-7" tabindex="-1"></a>   n <span class="ot">=</span> <span class="fu">length</span>(vec.x)</span>
<span id="cb203-8"><a href="newton-interpolation.html#cb203-8" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">length</span>(vec.y) <span class="sc">==</span> <span class="dv">0</span>) vec.y <span class="ot">=</span> <span class="fu">fn</span>(vec.x) <span class="co">#</span></span>
<span id="cb203-9"><a href="newton-interpolation.html#cb203-9" tabindex="-1"></a>   node.x <span class="ot">=</span> vec.x</span>
<span id="cb203-10"><a href="newton-interpolation.html#cb203-10" tabindex="-1"></a>   A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n<span class="sc">^</span><span class="dv">2</span>)), <span class="at">nrow =</span> n, <span class="at">ncol =</span> n, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb203-11"><a href="newton-interpolation.html#cb203-11" tabindex="-1"></a>   A[<span class="dv">1</span>,] <span class="ot">=</span> vec.y     <span class="co"># fill the first row with vec.y</span></span>
<span id="cb203-12"><a href="newton-interpolation.html#cb203-12" tabindex="-1"></a>   <span class="co">#</span></span>
<span id="cb203-13"><a href="newton-interpolation.html#cb203-13" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n)){</span>
<span id="cb203-14"><a href="newton-interpolation.html#cb203-14" tabindex="-1"></a>     <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb203-15"><a href="newton-interpolation.html#cb203-15" tabindex="-1"></a>      denominator <span class="ot">=</span> vec.x[j] <span class="sc">-</span> vec.x[j<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>(i<span class="dv">-2</span>)]</span>
<span id="cb203-16"><a href="newton-interpolation.html#cb203-16" tabindex="-1"></a>      numerator <span class="ot">=</span> A[i<span class="dv">-1</span>,j]<span class="sc">-</span> A[i<span class="dv">-1</span>,j<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb203-17"><a href="newton-interpolation.html#cb203-17" tabindex="-1"></a>      A[i,j] <span class="ot">=</span> numerator<span class="sc">/</span>denominator</span>
<span id="cb203-18"><a href="newton-interpolation.html#cb203-18" tabindex="-1"></a>      }</span>
<span id="cb203-19"><a href="newton-interpolation.html#cb203-19" tabindex="-1"></a>    }</span>
<span id="cb203-20"><a href="newton-interpolation.html#cb203-20" tabindex="-1"></a>  A</span>
<span id="cb203-21"><a href="newton-interpolation.html#cb203-21" tabindex="-1"></a> }</span></code></pre></div>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="newton-interpolation.html#cb204-1" tabindex="-1"></a><span class="do">##################################################################################</span></span>
<span id="cb204-2"><a href="newton-interpolation.html#cb204-2" tabindex="-1"></a><span class="do">##  Newton Interpolated Polynomial Approximation: vector-enabled input</span></span>
<span id="cb204-3"><a href="newton-interpolation.html#cb204-3" tabindex="-1"></a><span class="do">##################################################################################</span></span>
<span id="cb204-4"><a href="newton-interpolation.html#cb204-4" tabindex="-1"></a></span>
<span id="cb204-5"><a href="newton-interpolation.html#cb204-5" tabindex="-1"></a>Looping.Newton <span class="ot">=</span> <span class="cf">function</span>( vec.x,            <span class="co"># input interpolation nodes</span></span>
<span id="cb204-6"><a href="newton-interpolation.html#cb204-6" tabindex="-1"></a>                                <span class="at">vec.y =</span> <span class="cn">NULL</span>,    </span>
<span id="cb204-7"><a href="newton-interpolation.html#cb204-7" tabindex="-1"></a>                                <span class="at">fn =</span> <span class="cn">NULL</span>,        <span class="co"># either vec.y or fn must be provided</span></span>
<span id="cb204-8"><a href="newton-interpolation.html#cb204-8" tabindex="-1"></a>                                pred.x            <span class="co"># VECTOR INPUT!!!</span></span>
<span id="cb204-9"><a href="newton-interpolation.html#cb204-9" tabindex="-1"></a>                              ){</span>
<span id="cb204-10"><a href="newton-interpolation.html#cb204-10" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">length</span>(vec.y) <span class="sc">==</span><span class="dv">0</span>) vec.y <span class="ot">=</span> <span class="fu">fn</span>(vec.x)</span>
<span id="cb204-11"><a href="newton-interpolation.html#cb204-11" tabindex="-1"></a>   DivDif <span class="ot">=</span> <span class="fu">Divided.Dif</span>(vec.x, vec.y)[,<span class="dv">1</span>]       <span class="co"># the values in the first column of the div dif matrix</span></span>
<span id="cb204-12"><a href="newton-interpolation.html#cb204-12" tabindex="-1"></a>   n <span class="ot">=</span> <span class="fu">length</span>(vec.x)</span>
<span id="cb204-13"><a href="newton-interpolation.html#cb204-13" tabindex="-1"></a>   <span class="do">############</span></span>
<span id="cb204-14"><a href="newton-interpolation.html#cb204-14" tabindex="-1"></a>   m <span class="ot">=</span> <span class="fu">length</span>(pred.x)</span>
<span id="cb204-15"><a href="newton-interpolation.html#cb204-15" tabindex="-1"></a>   NV <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)                 <span class="co"># values of Nn(pred.x)</span></span>
<span id="cb204-16"><a href="newton-interpolation.html#cb204-16" tabindex="-1"></a>   <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb204-17"><a href="newton-interpolation.html#cb204-17" tabindex="-1"></a>   <span class="do">################</span></span>
<span id="cb204-18"><a href="newton-interpolation.html#cb204-18" tabindex="-1"></a>   Nn <span class="ot">=</span> vec.y[<span class="dv">1</span>]                  <span class="co"># f[xo]</span></span>
<span id="cb204-19"><a href="newton-interpolation.html#cb204-19" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){            <span class="co"># Must be n - 1 according to the last term in the polynomial</span></span>
<span id="cb204-20"><a href="newton-interpolation.html#cb204-20" tabindex="-1"></a>     cumProd <span class="ot">=</span> <span class="dv">1</span>                  <span class="co"># initial value to calculate the cumulative product</span></span>
<span id="cb204-21"><a href="newton-interpolation.html#cb204-21" tabindex="-1"></a>     <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>i){               <span class="co"># forward difference formula</span></span>
<span id="cb204-22"><a href="newton-interpolation.html#cb204-22" tabindex="-1"></a>       cumProd <span class="ot">=</span> cumProd<span class="sc">*</span>(pred.x[k]<span class="sc">-</span>vec.x[j])   <span class="co"># updating the cumulative product in the inner loop</span></span>
<span id="cb204-23"><a href="newton-interpolation.html#cb204-23" tabindex="-1"></a>     }</span>
<span id="cb204-24"><a href="newton-interpolation.html#cb204-24" tabindex="-1"></a>      Nn <span class="ot">=</span> Nn <span class="sc">+</span> DivDif[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">*</span>cumProd    <span class="co"># adding high order terms alliteratively to the Nn(x) </span></span>
<span id="cb204-25"><a href="newton-interpolation.html#cb204-25" tabindex="-1"></a>    }</span>
<span id="cb204-26"><a href="newton-interpolation.html#cb204-26" tabindex="-1"></a>    NV[k] <span class="ot">=</span> Nn                                  <span class="co"># return the value the Newton polynomial</span></span>
<span id="cb204-27"><a href="newton-interpolation.html#cb204-27" tabindex="-1"></a>   }</span>
<span id="cb204-28"><a href="newton-interpolation.html#cb204-28" tabindex="-1"></a> NV  </span>
<span id="cb204-29"><a href="newton-interpolation.html#cb204-29" tabindex="-1"></a>}</span></code></pre></div>
<p>The following code shows the computational time the above two functions take in the approximation.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="newton-interpolation.html#cb205-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb205-2"><a href="newton-interpolation.html#cb205-2" tabindex="-1"></a>pred.x <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">2.0</span>)   <span class="co"># pred.x is the argument is a local variable!</span></span>
<span id="cb205-3"><a href="newton-interpolation.html#cb205-3" tabindex="-1"></a>pred.NIP0 <span class="ot">=</span> <span class="fu">Vectorizing.Newton</span>(<span class="at">xvec =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb205-4"><a href="newton-interpolation.html#cb205-4" tabindex="-1"></a>                    <span class="at">yvec =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>), </span>
<span id="cb205-5"><a href="newton-interpolation.html#cb205-5" tabindex="-1"></a>                    <span class="at">pred.x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">2.0</span>))</span>
<span id="cb205-6"><a href="newton-interpolation.html#cb205-6" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">cbind</span>(<span class="at">pred.x =</span> pred.x, <span class="at">pred.NIP=</span>pred.NIP0))</span></code></pre></div>
<table style="width:28%;">
<colgroup>
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">pred.x</th>
<th align="center">pred.NIP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.6</td>
<td align="center">0.4554</td>
</tr>
<tr class="even">
<td align="center">1.1</td>
<td align="center">0.7196</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">0.2239</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="newton-interpolation.html#cb206-1" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code></pre></div>
<pre><code>## Time difference of 0.01446509 secs</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="newton-interpolation.html#cb208-1" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb208-2"><a href="newton-interpolation.html#cb208-2" tabindex="-1"></a>pred.x <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">2.0</span>)   <span class="co"># pred.x is the argument is a local variable!</span></span>
<span id="cb208-3"><a href="newton-interpolation.html#cb208-3" tabindex="-1"></a>pred.NIP <span class="ot">=</span> <span class="fu">Looping.Newton</span>(<span class="at">vec.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.6</span>, <span class="fl">1.9</span>, <span class="fl">2.2</span>),           </span>
<span id="cb208-4"><a href="newton-interpolation.html#cb208-4" tabindex="-1"></a>                    <span class="at">vec.y =</span> <span class="fu">c</span>(<span class="fl">0.7651977</span>, <span class="fl">0.6200860</span>, <span class="fl">0.4554022</span>, <span class="fl">0.2818186</span>, <span class="fl">0.1103623</span>), </span>
<span id="cb208-5"><a href="newton-interpolation.html#cb208-5" tabindex="-1"></a>                    <span class="at">pred.x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">2.0</span>))</span>
<span id="cb208-6"><a href="newton-interpolation.html#cb208-6" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">cbind</span>(<span class="at">pred.x =</span> pred.x, <span class="at">pred.NIP=</span>pred.NIP))</span></code></pre></div>
<table style="width:28%;">
<colgroup>
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">pred.x</th>
<th align="center">pred.NIP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.6</td>
<td align="center">0.4554</td>
</tr>
<tr class="even">
<td align="center">1.1</td>
<td align="center">0.7196</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">0.2239</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="newton-interpolation.html#cb209-1" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">Sys.time</span>() <span class="sc">-</span> start )</span></code></pre></div>
<pre><code>## Time difference of 0.0286901 secs</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lagrange-interpolation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gauss-elimination-method.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pengdsci/MAT325EB/edit/master/10-NewtonInterpolation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MAT325EB.pdf", "MAT325EB.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
